/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

// Patterns
//
// Author: Rok Garbas
// Contact: rok@garbas.si
// Version: 1.0
// Depends: jquery.js
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/*
Copyright 2012 Igor Vaynberg

Version: 3.4.2 Timestamp: Mon Aug 12 15:04:12 PDT 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/

/*! 
 * jquery.event.drag - v 2.2
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */

/*! 
 * jquery.event.drop - v 2.2
 * Copyright (c) 2010 Three Dub Media - http://threedubmedia.com
 * Open Source MIT License - http://threedubmedia.com/code/license
 */

// plone integration for select2
//
// Author: Rok Garbas
// Contact: rok@garbas.si
// Version: 1.0
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

/*!
 * pickadate.js v3.2.2, 2013/09/19
 * By Amsul, http://amsul.ca
 * Hosted on http://amsul.github.io/pickadate.js
 * Licensed under MIT
 */

/*!
 * Date picker for pickadate.js v3.2.2
 * http://amsul.github.io/pickadate.js/date.htm
 */

/*!
 * Time picker for pickadate.js v3.2.2
 * http://amsul.github.io/pickadate.js/time.htm
 */

// plone integration for pickadate.
//
// Author: Rok Garbas
// Contact: rok@garbas.si
// Version: 1.0
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

//     Underscore.js 1.5.1
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

// Pattern which Plone livesearch functionality on an input
//
// Author: Nathan Van Gheem
// Contact: nathan@vangheem.us
// Version: 1.0
//
// Adapted from queryhelper.js in Plone.
//
// License:
//
// Copyright (C) 2013 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

// plone integration for related items
//
// Author: Ryan Foster
// Contact: ryan@rynamic.com
// Version: 1.0
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

// querystring pattern.
//
// Author: Rok Garbas
// Contact: rok@garbas.si
// Version: 1.0
//
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

// Author: Rok Garbas
// Contact: rok@garbas.si
// Version: 1.0
// Description:
//
// License:
//
// Copyright (C) 2010 Plone Foundation
//
// This program is free software; you can redistribute it and/or modify it
// under the terms of the GNU General Public License as published by the Free
// Software Foundation; either version 2 of the License.
//
// This program is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
// more details.
//
// You should have received a copy of the GNU General Public License along with
// this program; if not, write to the Free Software Foundation, Inc., 51
// Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//

!function(){var e,t,n;!function(i){function r(e,t){return w.call(e,t)}function a(e,t){var n,i,r,a,s,o,l,c,u,h,p=t&&t.split("/"),d=y.map,f=d&&d["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),c=0;c<e.length;c+=1)if(h=e[c],"."===h)e.splice(c,1),c-=1;else if(".."===h){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||f)&&d){for(n=e.split("/"),c=n.length;c>0;c-=1){if(i=n.slice(0,c).join("/"),p)for(u=p.length;u>0;u-=1)if(r=d[p.slice(0,u).join("/")],r&&(r=r[i])){a=r,s=c;break}if(a)break;!o&&f&&f[i]&&(o=f[i],l=c)}!a&&o&&(a=o,s=l),a&&(n.splice(0,s,a),e=n.join("/"))}return e}function s(e,t){return function(){return d.apply(i,k.call(arguments,0).concat([e,t]))}}function o(e){return function(t){return a(t,e)}}function l(e){return function(t){g[e]=t}}function c(e){if(r(v,e)){var t=v[e];delete v[e],b[e]=!0,p.apply(i,t)}if(!r(g,e)&&!r(b,e))throw new Error("No "+e);return g[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function h(e){return function(){return y&&y.config&&y.config[e]||{}}}var p,d,f,m,g={},v={},y={},b={},w=Object.prototype.hasOwnProperty,k=[].slice;f=function(e,t){var n,i=u(e),r=i[0];return e=i[1],r&&(r=a(r,t),n=c(r)),r?e=n&&n.normalize?n.normalize(e,o(t)):a(e,t):(e=a(e,t),i=u(e),r=i[0],e=i[1],r&&(n=c(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},m={require:function(e){return s(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:h(e)}}},p=function(e,t,n,a){var o,u,h,p,d,y,w=[];if(a=a||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,d=0;d<t.length;d+=1)if(p=f(t[d],a),u=p.f,"require"===u)w[d]=m.require(e);else if("exports"===u)w[d]=m.exports(e),y=!0;else if("module"===u)o=w[d]=m.module(e);else if(r(g,u)||r(v,u)||r(b,u))w[d]=c(u);else{if(!p.p)throw new Error(e+" missing "+u);p.p.load(p.n,s(a,!0),l(u),{}),w[d]=g[u]}h=n.apply(g[e],w),e&&(o&&o.exports!==i&&o.exports!==g[e]?g[e]=o.exports:h===i&&y||(g[e]=h))}else e&&(g[e]=n)},e=t=d=function(e,t,n,r,a){return"string"==typeof e?m[e]?m[e](t):c(f(e,t).f):(e.splice||(y=e,t.splice?(e=t,t=n,n=null):e=i),t=t||function(){},"function"==typeof n&&(n=r,r=a),r?p(i,e,t,n):setTimeout(function(){p(i,e,t,n)},4),d)},d.config=function(e){return y=e,y.deps&&d(y.deps,y.callback),d},e._defined=g,n=function(e,t,n){t.splice||(n=t,t=[]),r(g,e)||r(v,e)||(v[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("node_modules/almond/almond.js",function(){}),n("mockup-registry",["jquery"],function(e,t){var n={patterns:{},warn:function(e){window.DEBUG&&console.warn(e)},getOptions:function(t,i,r){r=r||{},0===t.length||e.nodeName(t[0],"body")||(r=n.getOptions(t.parent(),i,r));var a={};if(0!==t.length&&(a=t.data("pat-"+i),a&&"string"==typeof a)){var s={};e.each(a.split(";"),function(e,t){if(t=t.split(":"),t.length>=1){t.reverse();var n=t.pop();n=n.replace(/^\s+|\s+$/g,""),t.reverse();var i=t.join(":");i=i.replace(/^\s+|\s+$/g,""),s[n]=i}}),a=s}return e.extend(!0,{},r,a)},init:function(e,i,r){var a=e.data("pattern-"+i);if(a===t&&n.patterns[i]){if(window.DEBUG)a=new n.patterns[i](e,n.getOptions(e,i,r));else try{a=new n.patterns[i](e,n.getOptions(e,i,r))}catch(s){n.warn('Failed while initializing "'+i+'" pattern.')}e.data("pattern-"+i,a)}return a},scan:function(t){var i=e(t),r=[];r=e.merge(r,i.filter('[class*="pat-"]')),r=e.merge(r,e('[class*="pat-"]',i)),e.each(r,function(t,i){i=e(i),e.each(i.attr("class").split(" "),function(e,t){0===t.indexOf("pat-")&&n.init(i,t.substr(4))})})},register:function(i){return i.prototype.name?(i.prototype.jqueryPlugin===t&&(i.prototype.jqueryPlugin="pattern"+i.prototype.name.charAt(0).toUpperCase()+i.prototype.name.slice(1)),e.fn[i.prototype.jqueryPlugin]=function(r,a){return e(this).each(function(){"object"==typeof r&&(a=r,r=t);var s=e(this),o=n.init(s,i.prototype.name,a);if(r){if(o[r]===t)return n.warn('Method "'+r+'" does not exists.'),!1;if("_"===r.charAt(0))return n.warn('Method "'+r+'" is private.'),!1;o[r].apply(o,[a])}}),this},n.patterns[i.prototype.name]=i,void 0):(n.warn("Pattern didn't specified a name."),!1)}};return n}),n("mockup-patterns-base",["jquery","mockup-registry"],function(e,t){var n=function(t,n){this.$el=t,this.options=e.extend(!0,{},this.defaults||{},n||{}),this.options.__returnDefaults!==!0&&(this.init(),this.trigger("init"))};return n.prototype={constructor:n,on:function(e,t){this.$el.on(e+"."+this.name+".patterns",t)},trigger:function(e,t){void 0===t&&(t=[]);try{t.splice(0,0,this)}catch(n){t=[this]}this.$el.trigger(e+"."+this.name+".patterns",t)}},n.extend=function(n){var i,r=this;i=n&&n.hasOwnProperty("constructor")?n.constructor:function(){r.apply(this,arguments)};var a=function(){this.constructor=i};return a.prototype=r.prototype,i.prototype=new a,i.extend=r.extend,e.extend(!0,i.prototype,n),i.__super__=r.prototype,t.register(i),i},n}),function(e){"undefined"==typeof e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var n=e([0]),i=-1,r=this.length;++i<r&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(jQuery),function(e,t){function n(e){var t,n,i,r;if(!e||e.length<1)return e;for(t="",n=0,i=e.length;i>n;n++)r=e.charAt(n),t+=U[r]||r;return t}function i(e,t){for(var n=0,i=t.length;i>n;n+=1)if(a(e,t[n]))return n;return-1}function r(){var t=e(M);t.appendTo("body");var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function a(e,n){return e===n?!0:e===t||n===t?!1:null===e||null===n?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function s(t,n){var i,r,a;if(null===t||t.length<1)return[];for(i=t.split(n),r=0,a=i.length;a>r;r+=1)i[r]=e.trim(i[r]);return i}function o(e){return e.outerWidth(!1)-e.width()}function l(n){var i="keyup-change-value";n.on("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.on("keyup",function(){var r=e.data(n,i);r!==t&&n.val()!==r&&(e.removeData(n,i),n.trigger("keyup-change"))})}function c(n){n.on("mousemove",function(n){var i=R;(i===t||i.x!==n.pageX||i.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function u(e,n,i){i=i||t;var r;return function(){var t=arguments;window.clearTimeout(r),r=window.setTimeout(function(){n.apply(i,t)},e)}}function h(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function p(e,t){var n=u(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){i(e.target,t.get())>=0&&n(e)})}function d(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],i=e.val().length;e.focus(),e.is(":visible")&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(i,i):n.createTextRange&&(t=n.createTextRange(),t.collapse(!1),t.select()))},0)}function f(t){t=e(t)[0];var n=0,i=0;if("selectionStart"in t)n=t.selectionStart,i=t.selectionEnd-n;else if("selection"in document){t.focus();var r=document.selection.createRange();i=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),n=r.text.length-i}return{offset:n,length:i}}function m(e){e.preventDefault(),e.stopPropagation()}function g(e){e.preventDefault(),e.stopImmediatePropagation()}function v(t){if(!j){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);j=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),j.attr("class","select2-sizer"),e("body").append(j)}return j.text(t.val()),j.width()}function y(t,n,i){var r,a,s=[];r=t.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0===this.indexOf("select2-")&&s.push(this)})),r=n.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(a=i(this),a&&s.push(this))})),t.attr("class",s.join(" "))}function b(e,t,i,r){var a=n(e.toUpperCase()).indexOf(n(t.toUpperCase())),s=t.length;return 0>a?(i.push(r(e)),void 0):(i.push(r(e.substring(0,a))),i.push("<span class='select2-match'>"),i.push(r(e.substring(a,a+s))),i.push("</span>"),i.push(r(e.substring(a+s,e.length))),void 0)}function w(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function k(n){var i,r=null,a=n.quietMillis||100,s=n.url,o=this;return function(l){window.clearTimeout(i),i=window.setTimeout(function(){var i=n.data,a=s,c=n.transport||e.fn.select2.ajaxDefaults.transport,u={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},h=e.extend({},e.fn.select2.ajaxDefaults.params,u);i=i?i.call(o,l.term,l.page,l.context):null,a="function"==typeof a?a.call(o,l.term,l.page,l.context):a,r&&r.abort(),n.params&&(e.isFunction(n.params)?e.extend(h,n.params.call(o)):e.extend(h,n.params)),e.extend(h,{url:a,dataType:n.dataType,data:i,success:function(e){var t=n.results(e,l.page);l.callback(t)}}),r=c.call(o,h)},a)}}function x(t){var n,i,r=t,a=function(e){return""+e.text};e.isArray(r)&&(i=r,r={results:i}),e.isFunction(r)===!1&&(i=r,r=function(){return i});var s=r();return s.text&&(a=s.text,e.isFunction(a)||(n=s.text,a=function(e){return e[n]})),function(t){var n,i=t.term,s={results:[]};return""===i?(t.callback(r()),void 0):(n=function(r,s){var o,l;if(r=r[0],r.children){o={};for(l in r)r.hasOwnProperty(l)&&(o[l]=r[l]);o.children=[],e(r.children).each2(function(e,t){n(t,o.children)}),(o.children.length||t.matcher(i,a(o),r))&&s.push(o)}else t.matcher(i,a(r),r)&&s.push(r)},e(r().results).each2(function(e,t){n(t,s.results)}),t.callback(s),void 0)}}function C(n){var i=e.isFunction(n);return function(r){var a=r.term,s={results:[]};e(i?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===a||r.matcher(a,n))&&s.results.push(e?this:{id:this,text:this})}),r.callback(s)}}function S(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error(n+" must be a function or a falsy value")}function T(t){return e.isFunction(t)?t():t}function _(t){var n=0;return e.each(t,function(e,t){t.children?n+=_(t.children):n++}),n}function O(e,n,i,r){var s,o,l,c,u,h=e,p=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return t;for(;;){for(o=-1,l=0,c=r.tokenSeparators.length;c>l&&(u=r.tokenSeparators[l],o=e.indexOf(u),!(o>=0));l++);if(0>o)break;if(s=e.substring(0,o),e=e.substring(o+u.length),s.length>0&&(s=r.createSearchChoice.call(this,s,n),s!==t&&null!==s&&r.id(s)!==t&&null!==r.id(s))){for(p=!1,l=0,c=n.length;c>l;l++)if(a(r.id(s),r.id(n[l]))){p=!0;break}p||i(s)}}return h!==e?e:void 0}function $(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var E,P,A,D,N,j,I,q,R={x:0,y:0},E={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case E.LEFT:case E.RIGHT:case E.UP:case E.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case E.SHIFT:case E.CTRL:case E.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},M="<div class='select2-measure-scrollbar'></div>",U={"Ⓐ":"A",Ａ:"A",À:"A",Á:"A",Â:"A",Ầ:"A",Ấ:"A",Ẫ:"A",Ẩ:"A",Ã:"A",Ā:"A",Ă:"A",Ằ:"A",Ắ:"A",Ẵ:"A",Ẳ:"A",Ȧ:"A",Ǡ:"A",Ä:"A",Ǟ:"A",Ả:"A",Å:"A",Ǻ:"A",Ǎ:"A",Ȁ:"A",Ȃ:"A",Ạ:"A",Ậ:"A",Ặ:"A",Ḁ:"A",Ą:"A",Ⱥ:"A",Ɐ:"A",Ꜳ:"AA",Æ:"AE",Ǽ:"AE",Ǣ:"AE",Ꜵ:"AO",Ꜷ:"AU",Ꜹ:"AV",Ꜻ:"AV",Ꜽ:"AY","Ⓑ":"B",Ｂ:"B",Ḃ:"B",Ḅ:"B",Ḇ:"B",Ƀ:"B",Ƃ:"B",Ɓ:"B","Ⓒ":"C",Ｃ:"C",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",Ç:"C",Ḉ:"C",Ƈ:"C",Ȼ:"C",Ꜿ:"C","Ⓓ":"D",Ｄ:"D",Ḋ:"D",Ď:"D",Ḍ:"D",Ḑ:"D",Ḓ:"D",Ḏ:"D",Đ:"D",Ƌ:"D",Ɗ:"D",Ɖ:"D",Ꝺ:"D",Ǳ:"DZ",Ǆ:"DZ",ǲ:"Dz",ǅ:"Dz","Ⓔ":"E",Ｅ:"E",È:"E",É:"E",Ê:"E",Ề:"E",Ế:"E",Ễ:"E",Ể:"E",Ẽ:"E",Ē:"E",Ḕ:"E",Ḗ:"E",Ĕ:"E",Ė:"E",Ë:"E",Ẻ:"E",Ě:"E",Ȅ:"E",Ȇ:"E",Ẹ:"E",Ệ:"E",Ȩ:"E",Ḝ:"E",Ę:"E",Ḙ:"E",Ḛ:"E",Ɛ:"E",Ǝ:"E","Ⓕ":"F",Ｆ:"F",Ḟ:"F",Ƒ:"F",Ꝼ:"F","Ⓖ":"G",Ｇ:"G",Ǵ:"G",Ĝ:"G",Ḡ:"G",Ğ:"G",Ġ:"G",Ǧ:"G",Ģ:"G",Ǥ:"G",Ɠ:"G","Ꞡ":"G",Ᵹ:"G",Ꝿ:"G","Ⓗ":"H",Ｈ:"H",Ĥ:"H",Ḣ:"H",Ḧ:"H",Ȟ:"H",Ḥ:"H",Ḩ:"H",Ḫ:"H",Ħ:"H",Ⱨ:"H",Ⱶ:"H","Ɥ":"H","Ⓘ":"I",Ｉ:"I",Ì:"I",Í:"I",Î:"I",Ĩ:"I",Ī:"I",Ĭ:"I",İ:"I",Ï:"I",Ḯ:"I",Ỉ:"I",Ǐ:"I",Ȉ:"I",Ȋ:"I",Ị:"I",Į:"I",Ḭ:"I",Ɨ:"I","Ⓙ":"J",Ｊ:"J",Ĵ:"J",Ɉ:"J","Ⓚ":"K",Ｋ:"K",Ḱ:"K",Ǩ:"K",Ḳ:"K",Ķ:"K",Ḵ:"K",Ƙ:"K",Ⱪ:"K",Ꝁ:"K",Ꝃ:"K",Ꝅ:"K","Ꞣ":"K","Ⓛ":"L",Ｌ:"L",Ŀ:"L",Ĺ:"L",Ľ:"L",Ḷ:"L",Ḹ:"L",Ļ:"L",Ḽ:"L",Ḻ:"L",Ł:"L",Ƚ:"L",Ɫ:"L",Ⱡ:"L",Ꝉ:"L",Ꝇ:"L",Ꞁ:"L",Ǉ:"LJ",ǈ:"Lj","Ⓜ":"M",Ｍ:"M",Ḿ:"M",Ṁ:"M",Ṃ:"M",Ɱ:"M",Ɯ:"M","Ⓝ":"N",Ｎ:"N",Ǹ:"N",Ń:"N",Ñ:"N",Ṅ:"N",Ň:"N",Ṇ:"N",Ņ:"N",Ṋ:"N",Ṉ:"N",Ƞ:"N",Ɲ:"N","Ꞑ":"N","Ꞥ":"N",Ǌ:"NJ",ǋ:"Nj","Ⓞ":"O",Ｏ:"O",Ò:"O",Ó:"O",Ô:"O",Ồ:"O",Ố:"O",Ỗ:"O",Ổ:"O",Õ:"O",Ṍ:"O",Ȭ:"O",Ṏ:"O",Ō:"O",Ṑ:"O",Ṓ:"O",Ŏ:"O",Ȯ:"O",Ȱ:"O",Ö:"O",Ȫ:"O",Ỏ:"O",Ő:"O",Ǒ:"O",Ȍ:"O",Ȏ:"O",Ơ:"O",Ờ:"O",Ớ:"O",Ỡ:"O",Ở:"O",Ợ:"O",Ọ:"O",Ộ:"O",Ǫ:"O",Ǭ:"O",Ø:"O",Ǿ:"O",Ɔ:"O",Ɵ:"O",Ꝋ:"O",Ꝍ:"O",Ƣ:"OI",Ꝏ:"OO",Ȣ:"OU","Ⓟ":"P",Ｐ:"P",Ṕ:"P",Ṗ:"P",Ƥ:"P",Ᵽ:"P",Ꝑ:"P",Ꝓ:"P",Ꝕ:"P","Ⓠ":"Q",Ｑ:"Q",Ꝗ:"Q",Ꝙ:"Q",Ɋ:"Q","Ⓡ":"R",Ｒ:"R",Ŕ:"R",Ṙ:"R",Ř:"R",Ȑ:"R",Ȓ:"R",Ṛ:"R",Ṝ:"R",Ŗ:"R",Ṟ:"R",Ɍ:"R",Ɽ:"R",Ꝛ:"R","Ꞧ":"R",Ꞃ:"R","Ⓢ":"S",Ｓ:"S",ẞ:"S",Ś:"S",Ṥ:"S",Ŝ:"S",Ṡ:"S",Š:"S",Ṧ:"S",Ṣ:"S",Ṩ:"S",Ș:"S",Ş:"S","Ȿ":"S","Ꞩ":"S",Ꞅ:"S","Ⓣ":"T",Ｔ:"T",Ṫ:"T",Ť:"T",Ṭ:"T",Ț:"T",Ţ:"T",Ṱ:"T",Ṯ:"T",Ŧ:"T",Ƭ:"T",Ʈ:"T",Ⱦ:"T",Ꞇ:"T",Ꜩ:"TZ","Ⓤ":"U",Ｕ:"U",Ù:"U",Ú:"U",Û:"U",Ũ:"U",Ṹ:"U",Ū:"U",Ṻ:"U",Ŭ:"U",Ü:"U",Ǜ:"U",Ǘ:"U",Ǖ:"U",Ǚ:"U",Ủ:"U",Ů:"U",Ű:"U",Ǔ:"U",Ȕ:"U",Ȗ:"U",Ư:"U",Ừ:"U",Ứ:"U",Ữ:"U",Ử:"U",Ự:"U",Ụ:"U",Ṳ:"U",Ų:"U",Ṷ:"U",Ṵ:"U",Ʉ:"U","Ⓥ":"V",Ｖ:"V",Ṽ:"V",Ṿ:"V",Ʋ:"V",Ꝟ:"V",Ʌ:"V",Ꝡ:"VY","Ⓦ":"W",Ｗ:"W",Ẁ:"W",Ẃ:"W",Ŵ:"W",Ẇ:"W",Ẅ:"W",Ẉ:"W",Ⱳ:"W","Ⓧ":"X",Ｘ:"X",Ẋ:"X",Ẍ:"X","Ⓨ":"Y",Ｙ:"Y",Ỳ:"Y",Ý:"Y",Ŷ:"Y",Ỹ:"Y",Ȳ:"Y",Ẏ:"Y",Ÿ:"Y",Ỷ:"Y",Ỵ:"Y",Ƴ:"Y",Ɏ:"Y",Ỿ:"Y","Ⓩ":"Z",Ｚ:"Z",Ź:"Z",Ẑ:"Z",Ż:"Z",Ž:"Z",Ẓ:"Z",Ẕ:"Z",Ƶ:"Z",Ȥ:"Z","Ɀ":"Z",Ⱬ:"Z",Ꝣ:"Z","ⓐ":"a",ａ:"a",ẚ:"a",à:"a",á:"a",â:"a",ầ:"a",ấ:"a",ẫ:"a",ẩ:"a",ã:"a",ā:"a",ă:"a",ằ:"a",ắ:"a",ẵ:"a",ẳ:"a",ȧ:"a",ǡ:"a",ä:"a",ǟ:"a",ả:"a",å:"a",ǻ:"a",ǎ:"a",ȁ:"a",ȃ:"a",ạ:"a",ậ:"a",ặ:"a",ḁ:"a",ą:"a",ⱥ:"a",ɐ:"a",ꜳ:"aa",æ:"ae",ǽ:"ae",ǣ:"ae",ꜵ:"ao",ꜷ:"au",ꜹ:"av",ꜻ:"av",ꜽ:"ay","ⓑ":"b",ｂ:"b",ḃ:"b",ḅ:"b",ḇ:"b",ƀ:"b",ƃ:"b",ɓ:"b","ⓒ":"c",ｃ:"c",ć:"c",ĉ:"c",ċ:"c",č:"c",ç:"c",ḉ:"c",ƈ:"c",ȼ:"c",ꜿ:"c",ↄ:"c","ⓓ":"d",ｄ:"d",ḋ:"d",ď:"d",ḍ:"d",ḑ:"d",ḓ:"d",ḏ:"d",đ:"d",ƌ:"d",ɖ:"d",ɗ:"d",ꝺ:"d",ǳ:"dz",ǆ:"dz","ⓔ":"e",ｅ:"e",è:"e",é:"e",ê:"e",ề:"e",ế:"e",ễ:"e",ể:"e",ẽ:"e",ē:"e",ḕ:"e",ḗ:"e",ĕ:"e",ė:"e",ë:"e",ẻ:"e",ě:"e",ȅ:"e",ȇ:"e",ẹ:"e",ệ:"e",ȩ:"e",ḝ:"e",ę:"e",ḙ:"e",ḛ:"e",ɇ:"e",ɛ:"e",ǝ:"e","ⓕ":"f",ｆ:"f",ḟ:"f",ƒ:"f",ꝼ:"f","ⓖ":"g",ｇ:"g",ǵ:"g",ĝ:"g",ḡ:"g",ğ:"g",ġ:"g",ǧ:"g",ģ:"g",ǥ:"g",ɠ:"g","ꞡ":"g",ᵹ:"g",ꝿ:"g","ⓗ":"h",ｈ:"h",ĥ:"h",ḣ:"h",ḧ:"h",ȟ:"h",ḥ:"h",ḩ:"h",ḫ:"h",ẖ:"h",ħ:"h",ⱨ:"h",ⱶ:"h",ɥ:"h",ƕ:"hv","ⓘ":"i",ｉ:"i",ì:"i",í:"i",î:"i",ĩ:"i",ī:"i",ĭ:"i",ï:"i",ḯ:"i",ỉ:"i",ǐ:"i",ȉ:"i",ȋ:"i",ị:"i",į:"i",ḭ:"i",ɨ:"i",ı:"i","ⓙ":"j",ｊ:"j",ĵ:"j",ǰ:"j",ɉ:"j","ⓚ":"k",ｋ:"k",ḱ:"k",ǩ:"k",ḳ:"k",ķ:"k",ḵ:"k",ƙ:"k",ⱪ:"k",ꝁ:"k",ꝃ:"k",ꝅ:"k","ꞣ":"k","ⓛ":"l",ｌ:"l",ŀ:"l",ĺ:"l",ľ:"l",ḷ:"l",ḹ:"l",ļ:"l",ḽ:"l",ḻ:"l",ſ:"l",ł:"l",ƚ:"l",ɫ:"l",ⱡ:"l",ꝉ:"l",ꞁ:"l",ꝇ:"l",ǉ:"lj","ⓜ":"m",ｍ:"m",ḿ:"m",ṁ:"m",ṃ:"m",ɱ:"m",ɯ:"m","ⓝ":"n",ｎ:"n",ǹ:"n",ń:"n",ñ:"n",ṅ:"n",ň:"n",ṇ:"n",ņ:"n",ṋ:"n",ṉ:"n",ƞ:"n",ɲ:"n",ŉ:"n","ꞑ":"n","ꞥ":"n",ǌ:"nj","ⓞ":"o",ｏ:"o",ò:"o",ó:"o",ô:"o",ồ:"o",ố:"o",ỗ:"o",ổ:"o",õ:"o",ṍ:"o",ȭ:"o",ṏ:"o",ō:"o",ṑ:"o",ṓ:"o",ŏ:"o",ȯ:"o",ȱ:"o",ö:"o",ȫ:"o",ỏ:"o",ő:"o",ǒ:"o",ȍ:"o",ȏ:"o",ơ:"o",ờ:"o",ớ:"o",ỡ:"o",ở:"o",ợ:"o",ọ:"o",ộ:"o",ǫ:"o",ǭ:"o",ø:"o",ǿ:"o",ɔ:"o",ꝋ:"o",ꝍ:"o",ɵ:"o",ƣ:"oi",ȣ:"ou",ꝏ:"oo","ⓟ":"p",ｐ:"p",ṕ:"p",ṗ:"p",ƥ:"p",ᵽ:"p",ꝑ:"p",ꝓ:"p",ꝕ:"p","ⓠ":"q",ｑ:"q",ɋ:"q",ꝗ:"q",ꝙ:"q","ⓡ":"r",ｒ:"r",ŕ:"r",ṙ:"r",ř:"r",ȑ:"r",ȓ:"r",ṛ:"r",ṝ:"r",ŗ:"r",ṟ:"r",ɍ:"r",ɽ:"r",ꝛ:"r","ꞧ":"r",ꞃ:"r","ⓢ":"s",ｓ:"s",ß:"s",ś:"s",ṥ:"s",ŝ:"s",ṡ:"s",š:"s",ṧ:"s",ṣ:"s",ṩ:"s",ș:"s",ş:"s",ȿ:"s","ꞩ":"s",ꞅ:"s",ẛ:"s","ⓣ":"t",ｔ:"t",ṫ:"t",ẗ:"t",ť:"t",ṭ:"t",ț:"t",ţ:"t",ṱ:"t",ṯ:"t",ŧ:"t",ƭ:"t",ʈ:"t",ⱦ:"t",ꞇ:"t",ꜩ:"tz","ⓤ":"u",ｕ:"u",ù:"u",ú:"u",û:"u",ũ:"u",ṹ:"u",ū:"u",ṻ:"u",ŭ:"u",ü:"u",ǜ:"u",ǘ:"u",ǖ:"u",ǚ:"u",ủ:"u",ů:"u",ű:"u",ǔ:"u",ȕ:"u",ȗ:"u",ư:"u",ừ:"u",ứ:"u",ữ:"u",ử:"u",ự:"u",ụ:"u",ṳ:"u",ų:"u",ṷ:"u",ṵ:"u",ʉ:"u","ⓥ":"v",ｖ:"v",ṽ:"v",ṿ:"v",ʋ:"v",ꝟ:"v",ʌ:"v",ꝡ:"vy","ⓦ":"w",ｗ:"w",ẁ:"w",ẃ:"w",ŵ:"w",ẇ:"w",ẅ:"w",ẘ:"w",ẉ:"w",ⱳ:"w","ⓧ":"x",ｘ:"x",ẋ:"x",ẍ:"x","ⓨ":"y",ｙ:"y",ỳ:"y",ý:"y",ŷ:"y",ỹ:"y",ȳ:"y",ẏ:"y",ÿ:"y",ỷ:"y",ẙ:"y",ỵ:"y",ƴ:"y",ɏ:"y",ỿ:"y","ⓩ":"z",ｚ:"z",ź:"z",ẑ:"z",ż:"z",ž:"z",ẓ:"z",ẕ:"z",ƶ:"z",ȥ:"z",ɀ:"z",ⱬ:"z",ꝣ:"z"};I=e(document),N=function(){var e=1;return function(){return e++}}(),I.on("mousemove",function(e){R.x=e.pageX,R.y=e.pageY}),P=$(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,a,s,o,u=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+N()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=h(function(){return n.element.closest("body")}),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(T(n.containerCss)),this.container.addClass(T(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(T(n.dropdownCssClass)),this.dropdown.data("select2",this),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.results=i=this.container.find(u),this.search=a=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),c(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",u,this.bind(this.highlightUnderEvent)),p(80,this.results),this.dropdown.on("scroll-debounced",u,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&i.mousewheel(function(e,t,n,r){var a=i.scrollTop();r>0&&0>=a-r?(i.scrollTop(0),m(e)):0>r&&i.get(0).scrollHeight-i.scrollTop()+r<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),m(e))}),l(a),a.on("keyup-change input paste",this.bind(this.updateResults)),a.on("focus",function(){a.addClass("select2-focused")}),a.on("blur",function(){a.removeClass("select2-focused")}),this.dropdown.on("mouseup",u,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var s=n.element.prop("disabled");s===t&&(s=!1),this.enable(!s);var o=n.element.prop("readonly");o===t&&(o=!1),this.readonly(o),q=q||r(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.nextSearchTerm=t},destroy:function(){var e=this.opts.element,n=e.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),n!==t&&(n.container.remove(),n.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:a(e.attr("locked"),"locked")||a(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var i,r,o,l,c=this;if(i=n.element,"select"===i.get(0).tagName.toLowerCase()&&(this.select=r=n.element),r&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(i,r,a){var s,o=this.opts.id;s=function(i,r,l){var u,h,p,d,f,m,g,v,y,b;for(i=n.sortResults(i,r,a),u=0,h=i.length;h>u;u+=1)p=i[u],f=p.disabled===!0,d=!f&&o(p)!==t,m=p.children&&p.children.length>0,g=e("<li></li>"),g.addClass("select2-results-dept-"+l),g.addClass("select2-result"),g.addClass(d?"select2-result-selectable":"select2-result-unselectable"),f&&g.addClass("select2-disabled"),m&&g.addClass("select2-result-with-children"),g.addClass(c.opts.formatResultCssClass(p)),v=e(document.createElement("div")),v.addClass("select2-result-label"),b=n.formatResult(p,v,a,c.opts.escapeMarkup),b!==t&&v.html(b),g.append(v),m&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),s(p.children,y,l+1),g.append(y)),g.data("select2-data",p),r.append(g)},s(r,i,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(o=n.id,n.id=function(e){return e[o]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(r?(n.query=this.bind(function(e){var n,r,a,s={results:[],more:!1},o=e.term;a=function(t,n){var i;t.is("option")?e.matcher(o,t.text(),t)&&n.push(c.optionToData(t)):t.is("optgroup")&&(i=c.optionToData(t),t.children().each2(function(e,t){a(t,i.children)}),i.children.length>0&&n.push(i))},n=i.children(),this.getPlaceholder()!==t&&n.length>0&&(r=this.getPlaceholderOption(),r&&(n=n.not(r))),n.each2(function(e,t){a(t,s.results)}),e.callback(s)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(l=n.element.data("ajax-url"),l&&l.length>0&&(n.ajax.url=l),n.query=k.call(n.element,n.ajax)):"data"in n?n.query=x(n.data):"tags"in n&&(n.query=C(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,i){var r=[];e(s(t.val(),n.separator)).each(function(){var t=this,i=this,s=n.tags;e.isFunction(s)&&(s=s()),e(s).each(function(){return a(this.id,t)?(i=this.text,!1):void 0}),r.push({id:t,text:i})}),i(r)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e,n=this.opts.element;n.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),e=this.bind(function(){var e,i=n.prop("disabled");i===t&&(i=!1),this.enable(!i);var e=n.prop("readonly");e===t&&(e=!1),this.readonly(e),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(T(this.opts.containerCssClass)),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(T(this.opts.dropdownCssClass))}),n.on("propertychange.select2 DOMAttrModified.select2",e),this.mutationCallback===t&&(this.mutationCallback=function(t){t.forEach(e)}),"undefined"!=typeof WebKitMutationObserver&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(this.mutationCallback),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){return e===t&&(e=!1),this._readonly===e?!1:(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,r,a=this.dropdown,s=this.container.offset(),o=this.container.outerHeight(!1),l=this.container.outerWidth(!1),c=a.outerHeight(!1),u=e(window).scrollLeft()+e(window).width(),h=e(window).scrollTop()+e(window).height(),p=s.top+o,d=s.left,f=h>=p+c,m=s.top-c>=this.body().scrollTop(),g=a.outerWidth(!1),v=u>=d+g,y=a.hasClass("select2-drop-above");this.opts.dropdownAutoWidth?(r=e(".select2-results",a)[0],a.addClass("select2-drop-auto-width"),a.css("width",""),g=a.outerWidth(!1)+(r.scrollHeight===r.clientHeight?0:q.width),g>l?l=g:g=l,v=u>=d+g):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(t=this.body().offset(),p-=t.top,d-=t.left),y?(n=!0,!m&&f&&(n=!1)):(n=!1,!f&&m&&(n=!0)),v||(d=s.left+l-g),n?(p=s.top-c,this.container.addClass("select2-drop-above"),a.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),a.removeClass("select2-drop-above")),i=e.extend({top:p,left:d,width:l},T(this.opts.dropdownCss)),a.css(i)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var t,n=this.containerId,i="scroll."+n,r="resize."+n,a="orientationchange."+n;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),t=e("#select2-drop-mask"),0==t.length&&(t=e(document.createElement("div")),t.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body()),t.on("mousedown touchstart click",function(t){var n,i=e("#select2-drop");i.length>0&&(n=i.data("select2"),n.opts.selectOnBlur&&n.selectHighlighted({noFocus:!0}),n.close({focus:!1}),t.preventDefault(),t.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var s=this;this.container.parents().add(window).each(function(){e(this).on(r+" "+i+" "+a,function(){s.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerId,n="scroll."+t,i="resize."+t,r="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(i).off(r)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return T(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t,n,i,r,a,s,o,l=this.results;if(n=this.highlight(),!(0>n)){if(0==n)return l.scrollTop(0),void 0;t=this.findHighlightableChoices().find(".select2-result-label"),i=e(t[n]),r=i.offset().top+i.outerHeight(!0),n===t.length-1&&(o=l.find("li.select2-more-results"),o.length>0&&(r=o.offset().top+o.outerHeight(!0))),a=l.offset().top+l.outerHeight(!0),r>a&&l.scrollTop(l.scrollTop()+(r-a)),s=i.offset().top-l.offset().top,0>s&&"none"!=i.css("display")&&l.scrollTop(l.scrollTop()+s)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),i=this.highlight();i>-1&&i<n.length;){i+=t;var r=e(n[i]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var n,r,a=this.findHighlightableChoices();return 0===arguments.length?i(a.filter(".select2-highlighted")[0],a.get()):(t>=a.length&&(t=a.length-1),0>t&&(t=0),this.removeHighlight(),n=e(a[t]),n.addClass("select2-highlighted"),this.ensureHighlightVisible(),r=n.data("select2-data"),r&&this.opts.element.trigger({type:"select2-highlight",val:this.id(r),choice:r}),void 0)},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(n))}else 0==n.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,r=this,a=this.search.val(),s=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:a,page:i,context:s,matcher:this.opts.matcher,callback:this.bind(function(e){r.opened()&&(r.opts.populateResults.call(this,t,e.results,{term:a,page:i,context:s}),r.postprocessResults(e,!1,!1),e.more===!0?(n.detach().appendTo(t).text(r.opts.formatLoadMore(i+1)),window.setTimeout(function(){r.loadMoreIfNeeded()},10)):n.remove(),r.positionDropdown(),r.resultsPage=i,r.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})})))},tokenize:function(){},updateResults:function(n){function i(){c.removeClass("select2-active"),p.positionDropdown()}function r(e){u.html(e),i()}var s,o,l,c=this.search,u=this.results,h=this.opts,p=this,d=c.val(),f=e.data(this.container,"select2-last-term");if((n===!0||!f||!a(d,f))&&(e.data(this.container,"select2-last-term",d),n===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var m=this.getMaximumSelectionSize();if(m>=1&&(s=this.data(),e.isArray(s)&&s.length>=m&&S(h.formatSelectionTooBig,"formatSelectionTooBig")))return r("<li class='select2-selection-limit'>"+h.formatSelectionTooBig(m)+"</li>"),void 0;if(c.val().length<h.minimumInputLength)return S(h.formatInputTooShort,"formatInputTooShort")?r("<li class='select2-no-results'>"+h.formatInputTooShort(c.val(),h.minimumInputLength)+"</li>"):r(""),n&&this.showSearch&&this.showSearch(!0),void 0;if(h.maximumInputLength&&c.val().length>h.maximumInputLength)return S(h.formatInputTooLong,"formatInputTooLong")?r("<li class='select2-no-results'>"+h.formatInputTooLong(c.val(),h.maximumInputLength)+"</li>"):r(""),void 0;h.formatSearching&&0===this.findHighlightableChoices().length&&r("<li class='select2-searching'>"+h.formatSearching()+"</li>"),c.addClass("select2-active"),this.removeHighlight(),o=this.tokenize(),o!=t&&null!=o&&c.val(o),this.resultsPage=1,h.query({element:h.element,term:c.val(),page:this.resultsPage,context:null,matcher:h.matcher,callback:this.bind(function(s){var o;if(l==this.queryCount){if(!this.opened())return this.search.removeClass("select2-active"),void 0;
if(this.context=s.context===t?null:s.context,this.opts.createSearchChoice&&""!==c.val()&&(o=this.opts.createSearchChoice.call(p,c.val(),s.results),o!==t&&null!==o&&p.id(o)!==t&&null!==p.id(o)&&0===e(s.results).filter(function(){return a(p.id(this),p.id(o))}).length&&s.results.unshift(o)),0===s.results.length&&S(h.formatNoMatches,"formatNoMatches"))return r("<li class='select2-no-results'>"+h.formatNoMatches(c.val())+"</li>"),void 0;u.empty(),p.opts.populateResults.call(this,u,s.results,{term:c.val(),page:this.resultsPage,context:null}),s.more===!0&&S(h.formatLoadMore,"formatLoadMore")&&(u.append("<li class='select2-more-results'>"+p.opts.escapeMarkup(h.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){p.loadMoreIfNeeded()},10)),this.postprocessResults(s,n),i(),this.opts.element.trigger({type:"select2-loaded",items:s})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){d(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),i=n.closest(".select2-result").data("select2-data");i?(this.highlight(t),this.onSelect(i,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var e=this.select.children().first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.text()&&""===e.val())return e}},initContainerWidth:function(){function n(){var n,i,r,a,s;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(i=n.split(";"),a=0,s=i.length;s>a;a+=1)if(r=i[a].replace(/\s/g,"").match(/[^-]width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var i=n.call(this);null!==i&&this.container.css("width",i)}}),A=$(P,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var n,i,r;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),n=this.search.get(0),n.createTextRange?(i=n.createTextRange(),i.collapse(!1),i.select()):n.setSelectionRange&&(r=this.search.val().length,n.setSelectionRange(r,r)),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(e){this.opened()&&(this.parent.close.apply(this,arguments),e=e||{focus:!0},this.focusser.removeAttr("disabled"),e.focus&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,n=this.container,i=this.dropdown;this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+N()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){if(e.which===E.PAGE_UP||e.which===E.PAGE_DOWN)return m(e),void 0;switch(e.which){case E.UP:case E.DOWN:return this.moveHighlight(e.which===E.UP?-1:1),m(e),void 0;case E.ENTER:return this.selectHighlighted(),m(e),void 0;case E.TAB:return this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),void 0;case E.ESC:return this.cancel(e),m(e),void 0}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==E.TAB&&!E.isControl(e)&&!E.isFunctionKey(e)&&e.which!==E.ESC){if(this.opts.openOnEnter===!1&&e.which===E.ENTER)return m(e),void 0;if(e.which==E.DOWN||e.which==E.UP||e.which==E.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),m(e),void 0}return e.which==E.DELETE||e.which==E.BACKSPACE?(this.opts.allowClear&&this.clear(),m(e),void 0):void 0}})),l(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),g(e),this.close(),this.selection.focus())})),t.on("mousedown",this.bind(function(t){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),m(t)})),i.on("mousedown",this.bind(function(){this.search.focus()})),t.on("focus",this.bind(function(e){m(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(e){var t=this.selection.data("select2-data");if(t){var n=this.getPlaceholderOption();this.opts.element.val(n?n.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var e;return this.opts.placeholder?(e=this.getPlaceholderOption())!==t&&e.is(":selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val():!1},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=e.find(":selected");t(n.optionToData(i))}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=n.val(),s=null;t.query({matcher:function(e,n,i){var o=a(r,t.id(i));return o&&(s=i),o},callback:e.isFunction(i)?function(){i(s)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var i=0,r=this;if(this.findHighlightableChoices().each2(function(e,t){return a(r.id(t.data("select2-data")),r.opts.element.val())?(i=e,!1):void 0}),n!==!1&&(t===!0&&i>=0?this.highlight(i):this.highlight(0)),t===!0){var s=this.opts.minimumResultsForSearch;s>=0&&this.showSearch(_(e.results)>=s)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||this.selection.focus(),a(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var n,i,r=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),r.empty(),null!==e&&(n=this.opts.formatSelection(e,r,this.opts.escapeMarkup)),n!==t&&r.append(n),i=this.opts.formatSelectionCssClass(e,r),i!==t&&r.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,i=null,r=this,a=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1]),this.select)this.select.val(e).find(":selected").each2(function(e,t){return i=r.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),n&&this.triggerChange({added:i,removed:a});else{if(!e&&0!==e)return this.clear(n),void 0;if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){r.opts.element.val(e?r.id(e):""),r.updateSelection(e),r.setPlaceholder(),n&&r.triggerChange({added:e,removed:a})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,i=!1;return 0===arguments.length?(n=this.selection.data("select2-data"),n==t&&(n=null),n):(arguments.length>1&&(i=arguments[1]),e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),i&&this.triggerChange({added:e,removed:n})):this.clear(i),void 0)}}),D=$(P,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=[];e.find(":selected").each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=s(n.val(),t.separator),o=[];t.query({matcher:function(n,i,s){var l=e.grep(r,function(e){return a(e,t.id(s))}).length;return l&&o.push(s),l},callback:e.isFunction(i)?function(){for(var e=[],n=0;n<r.length;n++)for(var s=r[n],l=0;l<o.length;l++){var c=o[l];if(a(s,t.id(c))){e.push(c),o.splice(l,1);break}}i(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n);var i=this;this.selection.on("click",".select2-search-choice",function(){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+N()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var n=t.find(".select2-search-choice-focus"),i=n.prev(".select2-search-choice:not(.select2-locked)"),r=n.next(".select2-search-choice:not(.select2-locked)"),a=f(this.search);if(n.length&&(e.which==E.LEFT||e.which==E.RIGHT||e.which==E.BACKSPACE||e.which==E.DELETE||e.which==E.ENTER)){var s=n;return e.which==E.LEFT&&i.length?s=i:e.which==E.RIGHT?s=r.length?r:null:e.which===E.BACKSPACE?(this.unselect(n.first()),this.search.width(10),s=i.length?i:r):e.which==E.DELETE?(this.unselect(n.first()),this.search.width(10),s=r.length?r:null):e.which==E.ENTER&&(s=null),this.selectChoice(s),m(e),s&&s.length||this.open(),void 0}if((e.which===E.BACKSPACE&&1==this.keydowns||e.which==E.LEFT)&&0==a.offset&&!a.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),m(e),void 0;if(this.selectChoice(null),this.opened())switch(e.which){case E.UP:case E.DOWN:return this.moveHighlight(e.which===E.UP?-1:1),m(e),void 0;case E.ENTER:return this.selectHighlighted(),m(e),void 0;case E.TAB:return this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),void 0;case E.ESC:return this.cancel(e),m(e),void 0}if(e.which!==E.TAB&&!E.isControl(e)&&!E.isFunctionKey(e)&&e.which!==E.BACKSPACE&&e.which!==E.ESC){if(e.which===E.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===E.PAGE_UP||e.which===E.PAGE_DOWN)&&m(e),e.which===E.ENTER&&m(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],a=this;e(t).each(function(){i(a.id(this),n)<0&&(n.push(a.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){a.addSelectedChoice(this)}),a.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,r,a=!n.locked,s=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),o=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=a?s:o,c=this.id(n),u=this.getVal();i=this.opts.formatSelection(n,l.find("div"),this.opts.escapeMarkup),i!=t&&l.find("div").replaceWith("<div>"+i+"</div>"),r=this.opts.formatSelectionCssClass(n,l.find("div")),r!=t&&l.addClass(r),a&&l.find(".select2-search-choice-close").on("mousedown",m).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),m(t))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",n),l.insertBefore(this.searchContainer),u.push(c),this.setVal(u)},unselect:function(e){var t,n,r=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),t&&(n=i(this.id(t),r),n>=0&&(r.splice(n,1),this.setVal(r),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))},postprocessResults:function(e,t,n){var r=this.getVal(),a=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),o=this;a.each2(function(e,t){var n=o.id(t.data("select2-data"));i(n,r)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&n!==!1&&o.highlight(0),!this.opts.createSearchChoice&&!a.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&S(o.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+o.opts.formatNoMatches(o.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-o(this.search)},resizeSearch:function(){var e,t,n,i,r,a=o(this.search);e=v(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,r=n-(t-i)-a,e>r&&(r=n-a),40>r&&(r=n-a),0>=r&&(r=e),this.search.width(r)},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),s(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){i(this,n)<0&&n.push(this)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator)))},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)a(this.opts.id(t[n]),this.opts.id(e[i]))&&(t.splice(n,1),n--,e.splice(i,1),i--);return{added:t,removed:e}},val:function(n,i){var r,a=this;if(0===arguments.length)return this.getVal();if(r=this.data(),r.length||(r=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),i&&this.triggerChange({added:this.data(),removed:r}),void 0;if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(r,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,a.id);a.setVal(n),a.updateSelection(t),a.clearSearch(),i&&a.triggerChange(a.buildChangeDetails(r,this.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var i,r,a=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(r=this.data(),t||(t=[]),i=e.map(t,function(e){return a.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(r,this.data())),void 0)}}),e.fn.select2=function(){var n,r,a,s,o,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],u=["opened","isFocused","container","dropdown"],h=["val","data"],p={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])n=0===l.length?{}:e.extend({},l[0]),n.element=e(this),"select"===n.element.get(0).tagName.toLowerCase()?o=n.element.prop("multiple"):(o=n.multiple||!1,"tags"in n&&(n.multiple=o=!0)),r=o?new D:new A,r.init(n);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(i(l[0],c)<0)throw"Unknown method: "+l[0];if(s=t,r=e(this).data("select2"),r===t)return;if(a=l[0],"container"===a?s=r.container:"dropdown"===a?s=r.dropdown:(p[a]&&(a=p[a]),s=r[a].apply(r,l.slice(1))),i(l[0],u)>=0||i(l[0],h)&&1==l.length)return!1}}),s===t?this:s},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var r=[];return b(e.text,n.term,r,i),r.join("")},formatSelection:function(e,n,i){return e?i(e.text):t},sortResults:function(e){return e},formatResultCssClass:function(){return t},formatSelectionCssClass:function(){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return n(""+t).toUpperCase().indexOf(n(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:O,escapeMarkup:w,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return t}},e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:k,local:x,tags:C},util:{debounce:u,markMatch:b,escapeMarkup:w,stripDiacritics:n},"class":{"abstract":P,single:A,multi:D}}}}(jQuery),n("select2",function(){}),function(e){e.fn.drag=function(t,n,i){var r="string"==typeof t?t:"",a=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==r.indexOf("drag")&&(r="drag"+r),i=(t==a?n:i)||{},a?this.bind(r,i,a):this.trigger(r)};var t=e.event,n=t.special,i=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,i.datakey),r=t.data||{};n.related+=1,e.each(i.defaults,function(e){void 0!==r[e]&&(n[e]=r[e])})},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){if(!e.data(this,i.datakey)){var n=e.extend({related:0},i.defaults);e.data(this,i.datakey,n),t.add(this,"touchstart mousedown",i.init,n),this.attachEvent&&this.attachEvent("ondragstart",i.dontstart)}},teardown:function(){var n=e.data(this,i.datakey)||{};n.related||(e.removeData(this,i.datakey),t.remove(this,"touchstart mousedown",i.init),i.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",i.dontstart))},init:function(r){if(!i.touched){var a,s=r.data;if(!(0!=r.which&&s.which>0&&r.which!=s.which||e(r.target).is(s.not)||s.handle&&!e(r.target).closest(s.handle,r.currentTarget).length||(i.touched="touchstart"==r.type?this:null,s.propagates=1,s.mousedown=this,s.interactions=[i.interaction(this,s)],s.target=r.target,s.pageX=r.pageX,s.pageY=r.pageY,s.dragging=null,a=i.hijack(r,"draginit",s),!s.propagates)))return a=i.flatten(a),a&&a.length&&(s.interactions=[],e.each(a,function(){s.interactions.push(i.interaction(this,s))})),s.propagates=s.interactions.length,s.drop!==!1&&n.drop&&n.drop.handler(r,s),i.textselect(!1),i.touched?t.add(i.touched,"touchmove touchend",i.handler,s):t.add(document,"mousemove mouseup",i.handler,s),!i.touched||s.live?!1:void 0}},interaction:function(t,n){var r=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new i.callback,droppable:[],offset:r}},handler:function(r){var a=r.data;switch(r.type){case!a.dragging&&"touchmove":r.preventDefault();case!a.dragging&&"mousemove":if(Math.pow(r.pageX-a.pageX,2)+Math.pow(r.pageY-a.pageY,2)<Math.pow(a.distance,2))break;r.target=a.target,i.hijack(r,"dragstart",a),a.propagates&&(a.dragging=!0);case"touchmove":r.preventDefault();case"mousemove":if(a.dragging){if(i.hijack(r,"drag",a),a.propagates){a.drop!==!1&&n.drop&&n.drop.handler(r,a);break}r.type="mouseup"}case"touchend":case"mouseup":default:i.touched?t.remove(i.touched,"touchmove touchend",i.handler):t.remove(document,"mousemove mouseup",i.handler),a.dragging&&(a.drop!==!1&&n.drop&&n.drop.handler(r,a),i.hijack(r,"dragend",a)),i.textselect(!0),a.click===!1&&a.dragging&&e.data(a.mousedown,"suppress.click",(new Date).getTime()+5),a.dragging=i.touched=!1}},hijack:function(n,r,a,s,o){if(a){var l,c,u,h={event:n.originalEvent,type:n.type},p=r.indexOf("drop")?"drag":"drop",d=s||0,f=isNaN(s)?a.interactions.length:s;n.type=r,n.originalEvent=null,a.results=[];do if(c=a.interactions[d]){if("dragend"!==r&&c.cancelled)continue;u=i.properties(n,a,c),c.results=[],e(o||c[p]||a.droppable).each(function(s,o){return u.target=o,n.isPropagationStopped=function(){return!1},l=o?t.dispatch.call(o,n,u):null,l===!1?("drag"==p&&(c.cancelled=!0,a.propagates-=1),"drop"==r&&(c[p][s]=null)):"dropinit"==r&&c.droppable.push(i.element(l)||o),"dragstart"==r&&(c.proxy=e(i.element(l)||c.drag)[0]),c.results.push(l),delete n.result,"dropinit"!==r?l:void 0}),a.results[d]=i.flatten(c.results),"dropinit"==r&&(c.droppable=i.flatten(c.droppable)),"dragstart"!=r||c.cancelled||u.update()}while(++d<f);return n.type=h.type,n.originalEvent=h.event,i.flatten(a.results)}},properties:function(e,t,n){var r=n.callback;return r.drag=n.drag,r.proxy=n.proxy||n.drag,r.startX=t.pageX,r.startY=t.pageY,r.deltaX=e.pageX-t.pageX,r.deltaY=e.pageY-t.pageY,r.originalX=n.offset.left,r.originalY=n.offset.top,r.offsetX=r.originalX+r.deltaX,r.offsetY=r.originalY+r.deltaY,r.drop=i.flatten((n.drop||[]).slice()),r.available=i.flatten((n.droppable||[]).slice()),r},element:function(e){return e&&(e.jquery||1==e.nodeType)?e:void 0},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?i.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",i.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};i.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,function(e){n.drop.locate(this,e)})}};var r=t.dispatch;t.dispatch=function(t){return e.data(this,"suppress."+t.type)-(new Date).getTime()>0?(e.removeData(this,"suppress."+t.type),void 0):r.apply(this,arguments)};var a=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var i=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;i&&e.each(a.props,function(e,n){t[n]=i[n]})}return t}};n.draginit=n.dragstart=n.dragend=i}(jQuery),n("jquery.event.drag",["jquery"],function(){}),function(e){e.fn.drop=function(t,n,i){var r="string"==typeof t?t:"",a=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==r.indexOf("drop")&&(r="drop"+r),i=(t==a?n:i)||{},a?this.bind(r,i,a):this.trigger(r)},e.drop=function(t){t=t||{},i.multi=t.multi===!0?1/0:t.multi===!1?1:isNaN(t.multi)?i.multi:t.multi,i.delay=t.delay||i.delay,i.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:i.tolerance,i.mode=t.mode||i.mode||"intersect"
};var t=e.event,n=t.special,i=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(){var t=e.data(this,i.datakey);t.related+=1},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){if(!e.data(this,i.datakey)){var t={related:0,active:[],anyactive:0,winner:0,location:{}};e.data(this,i.datakey,t),i.targets.push(this)}},teardown:function(){var t=e.data(this,i.datakey)||{};if(!t.related){e.removeData(this,i.datakey);var n=this;i.targets=e.grep(i.targets,function(e){return e!==n})}},handler:function(t,r){var a;if(r)switch(t.type){case"mousedown":case"touchstart":a=e(i.targets),"string"==typeof r.drop&&(a=a.filter(r.drop)),a.each(function(){var t=e.data(this,i.datakey);t.active=[],t.anyactive=0,t.winner=0}),r.droppable=a,n.drag.hijack(t,"dropinit",r);break;case"mousemove":case"touchmove":i.event=t,i.timer||i.tolerate(r);break;case"mouseup":case"touchend":i.timer=clearTimeout(i.timer),r.propagates&&(n.drag.hijack(t,"drop",r),n.drag.hijack(t,"dropend",r))}},locate:function(t,n){var r=e.data(t,i.datakey),a=e(t),s=a.offset()||{},o=a.outerHeight(),l=a.outerWidth(),c={elem:t,width:l,height:o,top:s.top,left:s.left,right:s.left+l,bottom:s.top+o};return r&&(r.location=c,r.index=n,r.elem=t),c},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,n){return this.contains(n,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,n){return Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top))*Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))},fit:function(e,t,n){return this.contains(n,t)?1:0},middle:function(e,t,n){return this.contains(n,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(t){var r,a,s,o,l,c,u,h,p=0,d=t.interactions.length,f=[i.event.pageX,i.event.pageY],m=i.tolerance||i.modes[i.mode];do if(h=t.interactions[p]){if(!h)return;h.drop=[],l=[],c=h.droppable.length,m&&(s=i.locate(h.proxy)),r=0;do if(u=h.droppable[r]){if(o=e.data(u,i.datakey),a=o.location,!a)continue;o.winner=m?m.call(i,i.event,s,a):i.contains(a,f)?1:0,l.push(o)}while(++r<c);l.sort(i.sort),r=0;do(o=l[r])&&(o.winner&&h.drop.length<i.multi?(o.active[p]||o.anyactive||(n.drag.hijack(i.event,"dropstart",t,p,o.elem)[0]!==!1?(o.active[p]=1,o.anyactive+=1):o.winner=0),o.winner&&h.drop.push(o.elem)):o.active[p]&&1==o.anyactive&&(n.drag.hijack(i.event,"dropend",t,p,o.elem),o.active[p]=0,o.anyactive-=1));while(++r<c)}while(++p<d);i.last&&f[0]==i.last.pageX&&f[1]==i.last.pageY?delete i.timer:i.timer=setTimeout(function(){i.tolerate(t)},i.delay),i.last=i.event}};n.dropinit=n.dropstart=n.dropend=i}(jQuery),n("jquery.event.drop",["jquery"],function(){}),n("mockup-patterns-select2",["jquery","mockup-patterns-base","select2","jquery.event.drag","jquery.event.drop"],function(e,t){var n=t.extend({name:"select2",defaults:{separator:","},initializeValues:function(){var t=this;t.options.initialValues&&(t.options.id=function(e){return e.id},t.options.initSelection=function(n,i){var r=[],a=n.val(),s=t.options.initialValues;"string"==typeof t.options.initialValues&&""!==t.options.initialValues&&("{"===t.options.initialValues[0]?s=JSON.parse(t.options.initialValues):(s={},e(t.options.initialValues.split(t.options.separator)).each(function(){var t=this.split(":"),n=e.trim(t[0]),i=e.trim(t[1]);s[n]=i}))),e(a.split(t.options.separator)).each(function(){var e=this;s[this]&&(e=s[this]),r.push({id:this,text:e})}),i(r)})},initializeTags:function(){var e=this;e.options.tags&&"string"==typeof e.options.tags&&(e.options.tags="["===e.options.tags.substr(0,1)?JSON.parse(e.options.tags):e.options.tags.split(e.options.separator))},initializeOrdering:function(){var t=this;if(t.options.orderable){var n=function(e){return e?e.text:void 0};t.options.formatSelection&&(n=t.options.formatSelection),t.options.formatSelection=function(i,r){return r.parents("li").drag("start",function(){return e(this).addClass("select2-choice-dragging"),t.$el.select2("onSortStart"),e.drop({tolerance:function(t,n,i){var r=t.pageY>i.top+i.height/2;return e.data(i.elem,"drop+reorder",r?"insertAfter":"insertBefore"),this.contains(i,[t.pageX,t.pageY])}}),e(this).clone().addClass("dragging").css({opacity:.75,position:"absolute"}).appendTo(document.body)}).drag(function(t,n){e(n.proxy).css({top:n.offsetY,left:n.offsetX});var i=n.drop[0],r=e.data(i||{},"drop+reorder");!i||i==n.current&&r==n.method||(e(this)[r](i),n.current=i,n.method=r,n.update())}).drag("end",function(n,i){e(this).removeClass("select2-choice-dragging"),t.$el.select2("onSortEnd"),e(i.proxy).remove()}).drop("init",function(e,t){return this==t.drag?!1:!0}),n(i,r)}}},initializeSelect2:function(){var e=this;e.$el.select2(e.options),e.$select2=e.$el.parent().find(".select2-container"),e.$el.parent().off("close.modal.patterns"),e.options.orderable&&e.$select2.addClass("select2-orderable")},init:function(){var t=this;if(t.options.ajax||t.options.vocabularyUrl){t.options.vocabularyUrl&&(t.options.multiple=!0,t.options.ajax=t.options.ajax||{},t.options.ajax.url=t.options.vocabularyUrl,t.options.initSelection=function(n,i){var r=[],a=n.val();e(a.split(t.options.separator)).each(function(){r.push({id:this,text:this})}),i(r)});var n="";t.options.ajax=e.extend({quietMillis:300,data:function(e,t){return n=e,{query:e,page_limit:10,page:t}},results:function(i){var r=i.results;if(t.options.vocabularyUrl){var a=[];e.each(i.results,function(e,t){a.push(t.id)}),r=[],""!==n&&-1===e.inArray(n,a)&&r.push({id:n,text:n}),e.each(i.results,function(e,t){r.push(t)})}return{results:r}}},t.options.ajax)}t.initializeValues(),t.initializeTags(),t.initializeOrdering(),t.initializeSelect2()}});return n}),function(e){"function"==typeof n&&n.amd?n("picker",["jquery"],e):this.Picker=e(jQuery)}(function(e){function t(i,r,a,s){function o(){return t._.node("div",t._.node("div",t._.node("div",t._.node("div",f.component.nodes(c.open),h.box),h.wrap),h.frame),h.holder)}function l(e){e.stopPropagation(),"focus"==e.type&&f.$root.addClass(h.focused),f.open()}if(!i)return t;var c={id:Math.abs(~~(1e9*Math.random()))},u=a?e.extend(!0,{},a.defaults,s):s||{},h=e.extend({},t.klasses(),u.klass),p=e(i),d=function(){return this.start()},f=d.prototype={constructor:d,$node:p,start:function(){return c&&c.start?f:(c.methods={},c.start=!0,c.open=!1,c.type=i.type,i.autofocus=i==document.activeElement,i.type="text",i.readOnly=!0,f.component=new a(f,u),f.$root=e(t._.node("div",o(),h.picker)).on({focusin:function(e){f.$root.removeClass(h.focused),e.stopPropagation()},"mousedown click":function(e){e.target!=f.$root.children()[0]&&e.stopPropagation()}}).on("click","[data-pick], [data-nav], [data-clear]",function(){var n=e(this),r=n.data(),a=n.hasClass(h.navDisabled)||n.hasClass(h.disabled),s=document.activeElement;s=s&&(s.type||s.href),(a||!e.contains(f.$root[0],s))&&i.focus(),r.nav&&!a?f.set("highlight",f.component.item.highlight,{nav:r.nav}):t._.isInteger(r.pick)&&!a?f.set("select",r.pick).close(!0):r.clear&&f.clear().close(!0)}),u.formatSubmit&&(f._hidden=e('<input type=hidden name="'+i.name+(u.hiddenSuffix||"_submit")+'"'+(p.data("value")?' value="'+t._.trigger(f.component.formats.toString,f.component,[u.formatSubmit,f.component.item.select])+'"':"")+">")[0]),p.addClass(h.input).on("focus.P"+c.id+" click.P"+c.id,l).on("change.P"+c.id,function(){f._hidden&&(f._hidden.value=i.value?t._.trigger(f.component.formats.toString,f.component,[u.formatSubmit,f.component.item.select]):"")}).on("keydown.P"+c.id,function(e){var t=e.keyCode,n=/^(8|46)$/.test(t);return 27==t?(f.close(),!1):((32==t||n||!c.open&&f.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?f.clear().close():f.open()),void 0)}).val(p.data("value")?t._.trigger(f.component.formats.toString,f.component,[u.format,f.component.item.select]):i.value).after(f._hidden).data(r,f),u.container?e(u.container).append(f.$root):p.after(f.$root),f.on({start:f.component.onStart,render:f.component.onRender,stop:f.component.onStop,open:f.component.onOpen,close:f.component.onClose,set:f.component.onSet}).on({start:u.onStart,render:u.onRender,stop:u.onStop,open:u.onOpen,close:u.onClose,set:u.onSet}),i.autofocus&&f.open(),f.trigger("start").trigger("render"))},render:function(e){return e?f.$root.html(o()):f.$root.find("."+h.box).html(f.component.nodes(c.open)),f.trigger("render")},stop:function(){return c.start?(f.close(),f._hidden&&f._hidden.parentNode.removeChild(f._hidden),f.$root.remove(),p.removeClass(h.input).off(".P"+c.id).removeData(r),i.type=c.type,i.readOnly=!1,f.trigger("stop"),c.methods={},c.start=!1,f):f},open:function(r){return c.open?f:(p.addClass(h.active),f.$root.addClass(h.opened),r!==!1&&(c.open=!0,p.focus(),n.on("click.P"+c.id+" focusin.P"+c.id,function(e){e.target!=i&&e.target!=document&&f.close()}).on("keydown.P"+c.id,function(n){var r=n.keyCode,a=f.component.key[r],s=n.target;27==r?f.close(!0):s!=i||!a&&13!=r?e.contains(f.$root[0],s)&&13==r&&(n.preventDefault(),s.click()):(n.preventDefault(),a?t._.trigger(f.component.key.go,f,[a]):f.$root.find("."+h.highlighted).hasClass(h.disabled)||f.set("select",f.component.item.highlight).close())})),f.trigger("open"))},close:function(e){return e&&(p.off("focus.P"+c.id).focus(),setTimeout(function(){p.on("focus.P"+c.id,l)},0)),p.removeClass(h.active),f.$root.removeClass(h.opened+" "+h.focused),c.open&&(c.open=!1,n.off(".P"+c.id)),f.trigger("close")},clear:function(){return f.set("clear")},set:function(e,n,i){var r,a,s=t._.isObject(e),o=s?e:{};if(e){s||(o[e]=n);for(r in o)a=o[r],f.component.item[r]&&f.component.set(r,a,i||{}),("select"==r||"clear"==r)&&p.val("clear"==r?"":t._.trigger(f.component.formats.toString,f.component,[u.format,f.component.get(r)])).trigger("change");f.render()}return f.trigger("set",o)},get:function(e,n){return e=e||"value",null!=c[e]?c[e]:"value"==e?i.value:f.component.item[e]?"string"==typeof n?t._.trigger(f.component.formats.toString,f.component,[n,f.component.get(e)]):f.component.get(e):void 0},on:function(e,n){var i,r,a=t._.isObject(e),s=a?e:{};if(e){a||(s[e]=n);for(i in s)r=s[i],c.methods[i]=c.methods[i]||[],c.methods[i].push(r)}return f},trigger:function(e,n){var i=c.methods[e];return i&&i.map(function(e){t._.trigger(e,f,[n])}),f}};return new d}var n=e(document);return t.klasses=function(e){return e=e||"picker",{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},t._={group:function(e){for(var n,i="",r=t._.trigger(e.min,e);r<=t._.trigger(e.max,e,[r]);r+=e.i)n=t._.trigger(e.item,e,[r]),i+=t._.node(e.node,n[0],n[1],n[2]);return i},node:function(t,n,i,r){return n?(n=e.isArray(n)?n.join(""):n,i=i?' class="'+i+'"':"",r=r?" "+r:"","<"+t+i+r+">"+n+"</"+t+">"):""},lead:function(e){return(10>e?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isObject:function(e){return{}.toString.call(e).indexOf("Object")>-1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&0===e%1}},t.extend=function(n,i){e.fn[n]=function(r,a){var s=this.data(n);return"picker"==r?s:s&&"string"==typeof r?(t._.trigger(s[r],s,[a]),this):this.each(function(){var a=e(this);a.data(n)||new t(this,n,i,r)})},e.fn[n].defaults=i.defaults},t}),function(e){"function"==typeof n&&n.amd?n("picker.date",["picker"],e):e(Picker)}(function(e){function t(e,t){var n=this,i=e.$node[0].value,r=e.$node.data("value"),a=r||i,s=r?t.formatSubmit:t.format;n.settings=t,n.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"navigate create validate",view:"create validate viewset",disable:"flipItem",enable:"flipItem"},n.item={},n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return e[0]===!0?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now").set("select",a||n.item.now,{format:s,data:function(e){return a&&(e.indexOf("mm")>-1||e.indexOf("m")>-1)}(n.formats.toArray(s))}),n.key={40:7,38:-7,39:1,37:-1,go:function(e){n.set("highlight",[n.item.highlight.year,n.item.highlight.month,n.item.highlight.date+e],{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){e.set("highlight",[e.get("view").year,this.value,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).focus()}),e.$root.find("."+t.klass.selectYear).on("change",function(){e.set("highlight",[this.value,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).focus()})}).on("open",function(){e.$root.find("button, select").attr("disabled",!1)}).on("close",function(){e.$root.find("button, select").attr("disabled",!0)})}var n=7,i=6;t.prototype.set=function(e,t,n){var i=this;return i.item["enable"==e?"disable":"flip"==e?"enable":e]=i.queue[e].split(" ").map(function(r){return t=i[r](e,t,n)}).pop(),"select"==e?i.set("highlight",i.item.select,n):"highlight"==e?i.set("view",i.item.highlight,n):("flip"==e||"min"==e||"max"==e||"disable"==e||"enable"==e)&&i.item.select&&i.item.highlight&&i.set("select",i.item.select,n).set("highlight",i.item.highlight,n),i},t.prototype.get=function(e){return this.item[e]},t.prototype.create=function(t,n,i){var r,a=this;return n=void 0===n?t:n,n==-1/0||1/0==n?r=n:e._.isObject(n)&&e._.isInteger(n.pick)?n=n.obj:$.isArray(n)?(n=new Date(n[0],n[1],n[2]),n=e._.isDate(n)?n:a.create().obj):n=e._.isInteger(n)||e._.isDate(n)?a.normalize(new Date(n),i):a.now(t,n,i),{year:r||n.getFullYear(),month:r||n.getMonth(),date:r||n.getDate(),day:r||n.getDay(),obj:r||n,pick:r||n.getTime()}},t.prototype.now=function(e,t,n){return t=new Date,n&&n.rel&&t.setDate(t.getDate()+n.rel),this.normalize(t,n)},t.prototype.navigate=function(t,n,i){if(e._.isObject(n)){for(var r=new Date(n.year,n.month+(i&&i.nav?i.nav:0),1),a=r.getFullYear(),s=r.getMonth(),o=n.date;e._.isDate(r)&&new Date(a,s,o).getMonth()!==s;)o-=1;n=[a,s,o]}return n},t.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},t.prototype.measure=function(t,n){var i=this;return n?e._.isInteger(n)&&(n=i.now(t,n,{rel:n})):n="min"==t?-1/0:1/0,n},t.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},t.prototype.validate=function(t,n,i){var r,a,s,o,l=this,c=n,u=i&&i.interval?i.interval:1,h=-1===l.item.enable,p=l.item.min,d=l.item.max,f=h&&l.item.disable.filter(function(t){if($.isArray(t)){var i=l.create(t).pick;i<n.pick?r=!0:i>n.pick&&(a=!0)}return e._.isInteger(t)}).length;if(!i.nav&&(!h&&l.disabled(n)||h&&l.disabled(n)&&(f||r||a)||n.pick<=p.pick||n.pick>=d.pick))for(h&&!f&&(!a&&u>0||!r&&0>u)&&(u*=-1);l.disabled(n)&&(Math.abs(u)>1&&(n.month<c.month||n.month>c.month)&&(n=c,u=Math.abs(u)/u),n.pick<=p.pick?(s=!0,u=1):n.pick>=d.pick&&(o=!0,u=-1),!s||!o);)n=l.create([n.year,n.month,n.date+u]);return n},t.prototype.disabled=function(t){var n=this,i=n.item.disable.filter(function(i){return e._.isInteger(i)?t.day===(n.settings.firstDay?i:i-1)%7:$.isArray(i)?t.pick===n.create(i).pick:void 0}).length;return t.pick<n.item.min.pick||t.pick>n.item.max.pick||-1===n.item.enable?!i:i},t.prototype.parse=function(t,n,i){var r=this,a={};if(!n||e._.isInteger(n)||$.isArray(n)||e._.isDate(n)||e._.isObject(n)&&e._.isInteger(n.pick))return n;if(!i||!i.format)throw"Need a formatting option to parse this..";return r.formats.toArray(i.format).map(function(t){var i=r.formats[t],s=i?e._.trigger(i,r,[n,a]):t.replace(/^!/,"").length;i&&(a[t]=n.substr(0,s)),n=n.substr(s)}),[a.yyyy||a.yy,+(a.mm||a.m)-(i.data?1:0),a.dd||a.d]},t.prototype.formats=function(){function t(e,t,n){var i=e.match(/\w+/)[0];return n.mm||n.m||(n.m=t.indexOf(i)),i.length}function n(e){return e.match(/\w+/)[0].length}return{d:function(t,n){return t?e._.digits(t):n.date},dd:function(t,n){return t?2:e._.lead(n.date)},ddd:function(e,t){return e?n(e):this.settings.weekdaysShort[t.day]},dddd:function(e,t){return e?n(e):this.settings.weekdaysFull[t.day]},m:function(t,n){return t?e._.digits(t):n.month+1},mm:function(t,n){return t?2:e._.lead(n.month+1)},mmm:function(e,n){var i=this.settings.monthsShort;return e?t(e,i,n):i[n.month]},mmmm:function(e,n){var i=this.settings.monthsFull;return e?t(e,i,n):i[n.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(t,n){var i=this;return i.formats.toArray(t).map(function(t){return e._.trigger(i.formats[t],i,[0,n])||t.replace(/^!/,"")}).join("")}}}(),t.prototype.flipItem=function(e,t){var n=this,i=n.item.disable,r=-1===n.item.enable;return"flip"==t?n.item.enable=r?1:-1:!r&&"enable"==e||r&&"disable"==e?i=n.removeDisabled(i,t):(!r&&"disable"==e||r&&"enable"==e)&&(i=n.addDisabled(i,t)),i},t.prototype.addDisabled=function(e,t){var n=this;return t.map(function(t){n.filterDisabled(e,t).length||e.push(t)}),e},t.prototype.removeDisabled=function(e,t){var n=this;return t.map(function(t){e=n.filterDisabled(e,t,1)}),e},t.prototype.filterDisabled=function(e,t,n){var i=$.isArray(t);return e.filter(function(e){var r=!i&&t===e||i&&$.isArray(e)&&t.toString()===e.toString();return n?!r:r})},t.prototype.nodes=function(t){var r=this,a=r.settings,s=r.item.now,o=r.item.select,l=r.item.highlight,c=r.item.view,u=r.item.disable,h=r.item.min,p=r.item.max,d=function(t){return a.firstDay&&t.push(t.shift()),e._.node("thead",e._.group({min:0,max:n-1,i:1,node:"th",item:function(e){return[t[e],a.klass.weekdays]}}))}((a.showWeekdaysFull?a.weekdaysFull:a.weekdaysShort).slice(0)),f=function(t){return e._.node("div"," ",a.klass["nav"+(t?"Next":"Prev")]+(t&&c.year>=p.year&&c.month>=p.month||!t&&c.year<=h.year&&c.month<=h.month?" "+a.klass.navDisabled:""),"data-nav="+(t||-1))},m=function(n){return a.selectMonths?e._.node("select",e._.group({min:0,max:11,i:1,node:"option",item:function(e){return[n[e],0,"value="+e+(c.month==e?" selected":"")+(c.year==h.year&&e<h.month||c.year==p.year&&e>p.month?" disabled":"")]}}),a.klass.selectMonth,t?"":"disabled"):e._.node("div",n[c.month],a.klass.month)},g=function(){var n=c.year,i=a.selectYears===!0?5:~~(a.selectYears/2);if(i){var r=h.year,s=p.year,o=n-i,l=n+i;if(r>o&&(l+=r-o,o=r),l>s){var u=o-r,d=l-s;o-=u>d?d:u,l=s}return e._.node("select",e._.group({min:o,max:l,i:1,node:"option",item:function(e){return[e,0,"value="+e+(n==e?" selected":"")]}}),a.klass.selectYear,t?"":"disabled")}return e._.node("div",n,a.klass.year)};return e._.node("div",f()+f(1)+m(a.showMonthsShort?a.monthsShort:a.monthsFull)+g(),a.klass.header)+e._.node("table",d+e._.node("tbody",e._.group({min:0,max:i-1,i:1,node:"tr",item:function(t){var i=a.firstDay&&0===r.create([c.year,c.month,1]).day?-7:0;return[e._.group({min:n*t-c.day+i+1,max:function(){return this.min+n-1},i:1,node:"td",item:function(t){return t=r.create([c.year,c.month,t+(a.firstDay?1:0)]),[e._.node("div",t.date,function(e){return e.push(c.month==t.month?a.klass.infocus:a.klass.outfocus),s.pick==t.pick&&e.push(a.klass.now),o&&o.pick==t.pick&&e.push(a.klass.selected),l&&l.pick==t.pick&&e.push(a.klass.highlighted),(u&&r.disabled(t)||t.pick<h.pick||t.pick>p.pick)&&e.push(a.klass.disabled),e.join(" ")}([a.klass.day]),"data-pick="+t.pick)]}})]}})),a.klass.table)+e._.node("div",e._.node("button",a.today,a.klass.buttonToday,"data-pick="+s.pick+(t?"":" disabled"))+e._.node("button",a.clear,a.klass.buttonClear,"data-clear=1"+(t?"":" disabled")),a.klass.footer)},t.defaults=function(e){return{monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today"}}}(e.klasses().picker+"__"),e.extend("pickadate",t)}),function(e){"function"==typeof n&&n.amd?n("picker.time",["picker"],e):e(Picker)}(function(e){function t(e,t){var n=this,i=e.$node.data("value");n.settings=t,n.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"create validate",view:"create validate",disable:"flipItem",enable:"flipItem"},n.item={},n.item.interval=t.interval||30,n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return e[0]===!0?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now").set("select",i||e.$node[0].value||n.item.min,{format:i?t.formatSubmit:t.format}),n.key={40:1,38:-1,39:1,37:-1,go:function(e){n.set("highlight",n.item.highlight.pick+e*n.item.interval,{interval:e*n.item.interval}),this.render()}},e.on("render",function(){var i=e.$root.children(),r=i.find("."+t.klass.viewset);r.length?i[0].scrollTop=~~(r.position().top-2*r[0].clientHeight):console.warn("Nothing to viewset with",n.item.view)}).on("open",function(){e.$root.find("button").attr("disable",!1)}).on("close",function(){e.$root.find("button").attr("disable",!0)})}var n=24,i=60,r=12,a=n*i;t.prototype.set=function(e,t,n){var i=this;return i.item["enable"==e?"disable":"flip"==e?"enable":e]=i.queue[e].split(" ").map(function(r){return t=i[r](e,t,n)}).pop(),"select"==e?i.set("highlight",i.item.select,n):"highlight"==e?i.set("view",i.item.highlight,n):"interval"==e?i.set("min",i.item.min,n).set("max",i.item.max,n):("flip"==e||"min"==e||"max"==e||"disable"==e||"enable"==e)&&i.item.select&&i.item.highlight&&("min"==e&&i.set("max",i.item.max,n),i.set("select",i.item.select,n).set("highlight",i.item.highlight,n)),i},t.prototype.get=function(e){return this.item[e]},t.prototype.create=function(t,r,s){var o=this;return r=void 0===r?t:r,e._.isObject(r)&&e._.isInteger(r.pick)?r=r.pick:$.isArray(r)?r=+r[0]*i+ +r[1]:e._.isInteger(r)||(r=o.now(t,r,s)),"max"==t&&r<o.item.min.pick&&(r+=a),r=o.normalize(r,s),{hour:~~(n+r/i)%n,mins:(i+r%i)%i,time:(a+r)%a,pick:r}},t.prototype.now=function(t,n){var r=new Date,a=r.getHours()*i+r.getMinutes();return e._.isInteger(n)?n+="min"==t&&0>n&&0===a?2:1:n=1,n*this.item.interval+a},t.prototype.normalize=function(e){return e-((0>e?this.item.interval:0)+e%this.item.interval)},t.prototype.measure=function(t,r,a){var s=this;return r?r===!0||e._.isInteger(r)?r=s.now(t,r,a):e._.isObject(r)&&e._.isInteger(r.pick)&&(r=s.normalize(r.pick,a)):r="min"==t?[0,0]:[n-1,i-1],r},t.prototype.validate=function(e,t,n){var i=this,r=n&&n.interval?n.interval:i.item.interval;return i.disabled(t)&&(t=i.shift(t,r)),t=i.scope(t),i.disabled(t)&&(t=i.shift(t,-1*r)),t},t.prototype.disabled=function(t){var n=this,i=n.item.disable.filter(function(i){return e._.isInteger(i)?t.hour==i:$.isArray(i)?t.pick==n.create(i).pick:void 0}).length;return-1===n.item.enable?!i:i},t.prototype.shift=function(e,t){for(var n=this;n.disabled(e)&&(e=n.create(e.pick+=t||n.item.interval),!(e.pick<=n.item.min.pick||e.pick>=n.item.max.pick)););return e},t.prototype.scope=function(e){var t=this.item.min.pick,n=this.item.max.pick;return this.create(e.pick>n?n:e.pick<t?t:e)},t.prototype.parse=function(t,n,r){var a=this,s={};if(!n||e._.isInteger(n)||$.isArray(n)||e._.isDate(n)||e._.isObject(n)&&e._.isInteger(n.pick))return n;if(!r||!r.format)throw"Need a formatting option to parse this..";return a.formats.toArray(r.format).map(function(t){var i=a.formats[t],r=i?e._.trigger(i,a,[n,s]):t.replace(/^!/,"").length;i&&(s[t]=n.substr(0,r)),n=n.substr(r)}),+s.i+i*(+(s.H||s.HH)||+(s.h||s.hh)%12+(/^p/i.test(s.A||s.a)?12:0))},t.prototype.formats={h:function(t,n){return t?e._.digits(t):n.hour%r||r},hh:function(t,n){return t?2:e._.lead(n.hour%r||r)},H:function(t,n){return t?e._.digits(t):""+n.hour%24},HH:function(t,n){return t?e._.digits(t):e._.lead(n.hour%24)},i:function(t,n){return t?2:e._.lead(n.mins)},a:function(e,t){return e?4:a/2>t.time%a?"a.m.":"p.m."},A:function(e,t){return e?2:a/2>t.time%a?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(t,n){var i=this;return i.formats.toArray(t).map(function(t){return e._.trigger(i.formats[t],i,[0,n])||t.replace(/^!/,"")}).join("")}},t.prototype.flipItem=function(e,t){var n=this,i=n.item.disable,r=-1===n.item.enable;return"flip"==t?n.item.enable=r?1:-1:!r&&"enable"==e||r&&"disable"==e?i=n.removeDisabled(i,t):(!r&&"disable"==e||r&&"enable"==e)&&(i=n.addDisabled(i,t)),i},t.prototype.addDisabled=function(e,t){var n=this;return t.map(function(t){n.filterDisabled(e,t).length||e.push(t)}),e},t.prototype.removeDisabled=function(e,t){var n=this;return t.map(function(t){e=n.filterDisabled(e,t,1)}),e},t.prototype.filterDisabled=function(e,t,n){var i=$.isArray(t);return e.filter(function(e){var r=!i&&t===e||i&&$.isArray(e)&&t.toString()===e.toString();return n?!r:r})},t.prototype.i=function(t,n){return e._.isInteger(n)&&n>0?n:this.item.interval},t.prototype.nodes=function(t){var n=this,i=n.settings,r=n.item.select,a=n.item.highlight,s=n.item.view,o=n.item.disable;return e._.node("ul",e._.group({min:n.item.min.pick,max:n.item.max.pick,i:n.item.interval,node:"li",item:function(t){return t=n.create(t),[e._.trigger(n.formats.toString,n,[e._.trigger(i.formatLabel,n,[t])||i.format,t]),function(e,l){return r&&r.pick==l&&e.push(i.klass.selected),a&&a.pick==l&&e.push(i.klass.highlighted),s&&s.pick==l&&e.push(i.klass.viewset),o&&n.disabled(t)&&e.push(i.klass.disabled),e.join(" ")}([i.klass.listItem],t.pick),"data-pick="+t.pick]}})+e._.node("li",e._.node("button",i.clear,i.klass.buttonClear,"data-clear=1"+(t?"":" disable"))),i.klass.list)},t.defaults=function(e){return{clear:"Clear",format:"h:i A",interval:30,klass:{picker:e+" "+e+"--time",holder:e+"__holder",list:e+"__list",listItem:e+"__list-item",disabled:e+"__list-item--disabled",selected:e+"__list-item--selected",highlighted:e+"__list-item--highlighted",viewset:e+"__list-item--viewset",now:e+"__list-item--now",buttonClear:e+"__button--clear"}}}(e.klasses().picker),e.extend("pickatime",t)}),n("mockup-patterns-pickadate",["jquery","mockup-patterns-base","picker","picker.date","picker.time"],function(e,t){var n=t.extend({name:"pickadate",defaults:{separator:" ",date:{selectYears:!0,selectMonths:!0},time:{},classWrapperName:"pattern-pickadate-wrapper",classSeparatorName:"pattern-pickadate-separator",classDateName:"pattern-pickadate-date",classDateWrapperName:"pattern-pickadate-date-wrapper",classTimeName:"pattern-pickadate-time",classTimeWrapperName:"pattern-pickadate-time-wrapper",classClearName:"pattern-pickadate-clear",placeholderDate:"Enter date...",placeholderTime:"Enter time..."},isFalse:function(e){return"string"==typeof e&&"false"===e?!1:e},init:function(){var t=this,n=t.$el.val().split(" "),i=n[0]||"",r=n[1]||"";t.options.date=t.isFalse(t.options.date),t.options.time=t.isFalse(t.options.time),t.options.date===!1&&(r=n[0]),t.$el.hide(),t.$wrapper=e("<div/>").addClass(t.options.classWrapperName).insertAfter(t.$el),t.options.date!==!1&&(t.options.date.formatSubmit="yyyy-mm-dd",t.$date=e('<input type="text"/>').attr("placeholder",t.options.placeholderDate).attr("data-value",i).addClass(t.options.classDateName).appendTo(e("<div/>").addClass(t.options.classDateWrapperName).appendTo(t.$wrapper)).pickadate(e.extend(!0,{},t.options.date,{onSet:function(e){void 0!==e.select&&(t.$date.attr("data-value",e.select),(t.options.time===!1||""!==t.$time.attr("data-value"))&&t.updateValue.call(t)),e.hasOwnProperty("clear")&&(t.$el.removeAttr("value"),t.$date.attr("data-value",""))}}))),t.options.date!==!1&&t.options.time!==!1&&(t.$separator=e("<span/>").addClass(t.options.classSeparatorName).html(" "===t.options.separator?"&nbsp;":t.options.separator).appendTo(t.$wrapper)),t.options.time!==!1&&(t.options.time.formatSubmit="HH:i",t.$time=e('<input type="text"/>').attr("placeholder",t.options.placeholderTime).attr("data-value",r).addClass(t.options.classTimeName).appendTo(e("<div/>").addClass(t.options.classTimeWrapperName).appendTo(t.$wrapper)).pickatime(e.extend(!0,{},t.options.time,{onSet:function(e){void 0!==e.select&&(t.$time.attr("data-value",e.select),(t.options.date===!1||""!==t.$date.attr("data-value"))&&t.updateValue.call(t)),e.hasOwnProperty("clear")&&(t.$el.removeAttr("value"),t.$time.attr("data-value",""))}})),"string"==typeof r&&"00"===r.substring(0,2)&&(t.$time.pickatime("picker").set("select",r.split(":")),t.$time.attr("data-value",r))),t.$clear=e("<div/>").addClass(t.options.classClearName).appendTo(t.$wrapper)},updateValue:function(){var e=this,t="";if(e.options.date!==!1){var n=e.$date.data("pickadate").component,i=e.$date.data("pickadate").get("select"),r=n.formats.toString;t+=r.apply(n,["yyyy-mm-dd",i])}if(e.options.date!==!1&&e.options.time!==!1&&(t+=" "),e.options.time!==!1){var a=e.$time.data("pickatime").component,s=e.$time.data("pickatime").get("select"),o=a.formats.toString;t+=o.apply(a,["HH:i",s])}e.$el.attr("value",t),e.trigger("updated")}});return n}),function(){var e=this,t=e._,n={},i=Array.prototype,r=Object.prototype,a=Function.prototype,s=i.push,o=i.slice,l=i.concat,c=r.toString,u=r.hasOwnProperty,h=i.forEach,p=i.map,d=i.reduce,f=i.reduceRight,m=i.filter,g=i.every,v=i.some,y=i.indexOf,b=i.lastIndexOf,w=Array.isArray,k=Object.keys,x=a.bind,C=function(e){return e instanceof C?e:this instanceof C?(this._wrapped=e,void 0):new C(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports._=C):e._=C,C.VERSION="1.5.1";var S=C.each=C.forEach=function(e,t,i){if(null!=e)if(h&&e.forEach===h)e.forEach(t,i);else if(e.length===+e.length){for(var r=0,a=e.length;a>r;r++)if(t.call(i,e[r],r,e)===n)return}else for(var s in e)if(C.has(e,s)&&t.call(i,e[s],s,e)===n)return};C.map=C.collect=function(e,t,n){var i=[];return null==e?i:p&&e.map===p?e.map(t,n):(S(e,function(e,r,a){i.push(t.call(n,e,r,a))}),i)};var T="Reduce of empty array with no initial value";C.reduce=C.foldl=C.inject=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),d&&e.reduce===d)return i&&(t=C.bind(t,i)),r?e.reduce(t,n):e.reduce(t);if(S(e,function(e,a,s){r?n=t.call(i,n,e,a,s):(n=e,r=!0)}),!r)throw new TypeError(T);return n},C.reduceRight=C.foldr=function(e,t,n,i){var r=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return i&&(t=C.bind(t,i)),r?e.reduceRight(t,n):e.reduceRight(t);var a=e.length;if(a!==+a){var s=C.keys(e);a=s.length}if(S(e,function(o,l,c){l=s?s[--a]:--a,r?n=t.call(i,n,e[l],l,c):(n=e[l],r=!0)}),!r)throw new TypeError(T);return n},C.find=C.detect=function(e,t,n){var i;return _(e,function(e,r,a){return t.call(n,e,r,a)?(i=e,!0):void 0}),i},C.filter=C.select=function(e,t,n){var i=[];return null==e?i:m&&e.filter===m?e.filter(t,n):(S(e,function(e,r,a){t.call(n,e,r,a)&&i.push(e)}),i)},C.reject=function(e,t,n){return C.filter(e,function(e,i,r){return!t.call(n,e,i,r)},n)},C.every=C.all=function(e,t,i){t||(t=C.identity);var r=!0;return null==e?r:g&&e.every===g?e.every(t,i):(S(e,function(e,a,s){return(r=r&&t.call(i,e,a,s))?void 0:n}),!!r)};var _=C.some=C.any=function(e,t,i){t||(t=C.identity);var r=!1;return null==e?r:v&&e.some===v?e.some(t,i):(S(e,function(e,a,s){return r||(r=t.call(i,e,a,s))?n:void 0}),!!r)};C.contains=C.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):_(e,function(e){return e===t})},C.invoke=function(e,t){var n=o.call(arguments,2),i=C.isFunction(t);return C.map(e,function(e){return(i?t:e[t]).apply(e,n)})},C.pluck=function(e,t){return C.map(e,function(e){return e[t]
})},C.where=function(e,t,n){return C.isEmpty(t)?n?void 0:[]:C[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},C.findWhere=function(e,t){return C.where(e,t,!0)},C.max=function(e,t,n){if(!t&&C.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&C.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return S(e,function(e,r,a){var s=t?t.call(n,e,r,a):e;s>i.computed&&(i={value:e,computed:s})}),i.value},C.min=function(e,t,n){if(!t&&C.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&C.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return S(e,function(e,r,a){var s=t?t.call(n,e,r,a):e;s<i.computed&&(i={value:e,computed:s})}),i.value},C.shuffle=function(e){var t,n=0,i=[];return S(e,function(e){t=C.random(n++),i[n-1]=i[t],i[t]=e}),i};var O=function(e){return C.isFunction(e)?e:function(t){return t[e]}};C.sortBy=function(e,t,n){var i=O(t);return C.pluck(C.map(e,function(e,t,r){return{value:e,index:t,criteria:i.call(n,e,t,r)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index<t.index?-1:1}),"value")};var $=function(e,t,n,i){var r={},a=O(null==t?C.identity:t);return S(e,function(t,s){var o=a.call(n,t,s,e);i(r,o,t)}),r};C.groupBy=function(e,t,n){return $(e,t,n,function(e,t,n){(C.has(e,t)?e[t]:e[t]=[]).push(n)})},C.countBy=function(e,t,n){return $(e,t,n,function(e,t){C.has(e,t)||(e[t]=0),e[t]++})},C.sortedIndex=function(e,t,n,i){n=null==n?C.identity:O(n);for(var r=n.call(i,t),a=0,s=e.length;s>a;){var o=a+s>>>1;n.call(i,e[o])<r?a=o+1:s=o}return a},C.toArray=function(e){return e?C.isArray(e)?o.call(e):e.length===+e.length?C.map(e,C.identity):C.values(e):[]},C.size=function(e){return null==e?0:e.length===+e.length?e.length:C.keys(e).length},C.first=C.head=C.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:o.call(e,0,t)},C.initial=function(e,t,n){return o.call(e,0,e.length-(null==t||n?1:t))},C.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:o.call(e,Math.max(e.length-t,0))},C.rest=C.tail=C.drop=function(e,t,n){return o.call(e,null==t||n?1:t)},C.compact=function(e){return C.filter(e,C.identity)};var E=function(e,t,n){return t&&C.every(e,C.isArray)?l.apply(n,e):(S(e,function(e){C.isArray(e)||C.isArguments(e)?t?s.apply(n,e):E(e,t,n):n.push(e)}),n)};C.flatten=function(e,t){return E(e,t,[])},C.without=function(e){return C.difference(e,o.call(arguments,1))},C.uniq=C.unique=function(e,t,n,i){C.isFunction(t)&&(i=n,n=t,t=!1);var r=n?C.map(e,n,i):e,a=[],s=[];return S(r,function(n,i){(t?i&&s[s.length-1]===n:C.contains(s,n))||(s.push(n),a.push(e[i]))}),a},C.union=function(){return C.uniq(C.flatten(arguments,!0))},C.intersection=function(e){var t=o.call(arguments,1);return C.filter(C.uniq(e),function(e){return C.every(t,function(t){return C.indexOf(t,e)>=0})})},C.difference=function(e){var t=l.apply(i,o.call(arguments,1));return C.filter(e,function(e){return!C.contains(t,e)})},C.zip=function(){for(var e=C.max(C.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=C.pluck(arguments,""+n);return t},C.object=function(e,t){if(null==e)return{};for(var n={},i=0,r=e.length;r>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},C.indexOf=function(e,t,n){if(null==e)return-1;var i=0,r=e.length;if(n){if("number"!=typeof n)return i=C.sortedIndex(e,t),e[i]===t?i:-1;i=0>n?Math.max(0,r+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r>i;i++)if(e[i]===t)return i;return-1},C.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(b&&e.lastIndexOf===b)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var r=i?n:e.length;r--;)if(e[r]===t)return r;return-1},C.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),r=0,a=new Array(i);i>r;)a[r++]=e,e+=n;return a};var P=function(){};C.bind=function(e,t){var n,i;if(x&&e.bind===x)return x.apply(e,o.call(arguments,1));if(!C.isFunction(e))throw new TypeError;return n=o.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(o.call(arguments)));P.prototype=e.prototype;var r=new P;P.prototype=null;var a=e.apply(r,n.concat(o.call(arguments)));return Object(a)===a?a:r}},C.partial=function(e){var t=o.call(arguments,1);return function(){return e.apply(this,t.concat(o.call(arguments)))}},C.bindAll=function(e){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return S(t,function(t){e[t]=C.bind(e[t],e)}),e},C.memoize=function(e,t){var n={};return t||(t=C.identity),function(){var i=t.apply(this,arguments);return C.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},C.delay=function(e,t){var n=o.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},C.defer=function(e){return C.delay.apply(C,[e,1].concat(o.call(arguments,1)))},C.throttle=function(e,t,n){var i,r,a,s=null,o=0;n||(n={});var l=function(){o=n.leading===!1?0:new Date,s=null,a=e.apply(i,r)};return function(){var c=new Date;o||n.leading!==!1||(o=c);var u=t-(c-o);return i=this,r=arguments,0>=u?(clearTimeout(s),s=null,o=c,a=e.apply(i,r)):s||n.trailing===!1||(s=setTimeout(l,u)),a}},C.debounce=function(e,t,n){var i,r=null;return function(){var a=this,s=arguments,o=function(){r=null,n||(i=e.apply(a,s))},l=n&&!r;return clearTimeout(r),r=setTimeout(o,t),l&&(i=e.apply(a,s)),i}},C.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},C.wrap=function(e,t){return function(){var n=[e];return s.apply(n,arguments),t.apply(this,n)}},C.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},C.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},C.keys=k||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)C.has(e,n)&&t.push(n);return t},C.values=function(e){var t=[];for(var n in e)C.has(e,n)&&t.push(e[n]);return t},C.pairs=function(e){var t=[];for(var n in e)C.has(e,n)&&t.push([n,e[n]]);return t},C.invert=function(e){var t={};for(var n in e)C.has(e,n)&&(t[e[n]]=n);return t},C.functions=C.methods=function(e){var t=[];for(var n in e)C.isFunction(e[n])&&t.push(n);return t.sort()},C.extend=function(e){return S(o.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},C.pick=function(e){var t={},n=l.apply(i,o.call(arguments,1));return S(n,function(n){n in e&&(t[n]=e[n])}),t},C.omit=function(e){var t={},n=l.apply(i,o.call(arguments,1));for(var r in e)C.contains(n,r)||(t[r]=e[r]);return t},C.defaults=function(e){return S(o.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},C.clone=function(e){return C.isObject(e)?C.isArray(e)?e.slice():C.extend({},e):e},C.tap=function(e,t){return t(e),e};var A=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof C&&(e=e._wrapped),t instanceof C&&(t=t._wrapped);var r=c.call(e);if(r!=c.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var a=n.length;a--;)if(n[a]==e)return i[a]==t;var s=e.constructor,o=t.constructor;if(s!==o&&!(C.isFunction(s)&&s instanceof s&&C.isFunction(o)&&o instanceof o))return!1;n.push(e),i.push(t);var l=0,u=!0;if("[object Array]"==r){if(l=e.length,u=l==t.length)for(;l--&&(u=A(e[l],t[l],n,i)););}else{for(var h in e)if(C.has(e,h)&&(l++,!(u=C.has(t,h)&&A(e[h],t[h],n,i))))break;if(u){for(h in t)if(C.has(t,h)&&!l--)break;u=!l}}return n.pop(),i.pop(),u};C.isEqual=function(e,t){return A(e,t,[],[])},C.isEmpty=function(e){if(null==e)return!0;if(C.isArray(e)||C.isString(e))return 0===e.length;for(var t in e)if(C.has(e,t))return!1;return!0},C.isElement=function(e){return!(!e||1!==e.nodeType)},C.isArray=w||function(e){return"[object Array]"==c.call(e)},C.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){C["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),C.isArguments(arguments)||(C.isArguments=function(e){return!(!e||!C.has(e,"callee"))}),"function"!=typeof/./&&(C.isFunction=function(e){return"function"==typeof e}),C.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},C.isNaN=function(e){return C.isNumber(e)&&e!=+e},C.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},C.isNull=function(e){return null===e},C.isUndefined=function(e){return void 0===e},C.has=function(e,t){return u.call(e,t)},C.noConflict=function(){return e._=t,this},C.identity=function(e){return e},C.times=function(e,t,n){for(var i=Array(Math.max(0,e)),r=0;e>r;r++)i[r]=t.call(n,r);return i},C.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};D.unescape=C.invert(D.escape);var N={escape:new RegExp("["+C.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+C.keys(D.unescape).join("|")+")","g")};C.each(["escape","unescape"],function(e){C[e]=function(t){return null==t?"":(""+t).replace(N[e],function(t){return D[e][t]})}}),C.result=function(e,t){if(null==e)return void 0;var n=e[t];return C.isFunction(n)?n.call(e):n},C.mixin=function(e){S(C.functions(e),function(t){var n=C[t]=e[t];C.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),M.call(this,n.apply(C,e))}})};var j=0;C.uniqueId=function(e){var t=++j+"";return e?e+t:t},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;C.template=function(e,t,n){var i;n=C.defaults({},n,C.templateSettings);var r=new RegExp([(n.escape||I).source,(n.interpolate||I).source,(n.evaluate||I).source].join("|")+"|$","g"),a=0,s="__p+='";e.replace(r,function(t,n,i,r,o){return s+=e.slice(a,o).replace(R,function(e){return"\\"+q[e]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(s+="';\n"+r+"\n__p+='"),a=o+t.length,t}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(n.variable||"obj","_",s)}catch(o){throw o.source=s,o}if(t)return i(t,C);var l=function(e){return i.call(this,e,C)};return l.source="function("+(n.variable||"obj")+"){\n"+s+"}",l},C.chain=function(e){return C(e).chain()};var M=function(e){return this._chain?C(e).chain():e};C.mixin(C),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];C.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],M.call(this,n)}}),S(["concat","join","slice"],function(e){var t=i[e];C.prototype[e]=function(){return M.call(this,t.apply(this._wrapped,arguments))}}),C.extend(C.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),n("underscore",function(e){return function(){var t;return t||e.window._}}(this)),n("mockup-patterns-queryhelper",["jquery","mockup-patterns-base"],function(e,t){var n=t.extend({name:"queryhelper",defaults:{basePattern:null,vocabularyUrl:null,searchParam:"SearchableText",attributes:["UID","Title","Description","getURL","Type"],batchSize:10,baseCriteria:[],pathDepth:1},init:function(){var e=this;e.basePattern=e.options.basePattern,void 0===e.basePattern&&(e.basePattern={browsing:!1,basePath:"/"}),e.options.url&&!e.options.vocabularyUrl&&(e.options.vocabularyUrl=e.options.url),e.valid=void 0!==e.options.vocabularyUrl&&null!==e.options.vocabularyUrl?!0:!1},getCurrentPath:function(){var e,t=this,n=t.basePattern;e=t.currentPath?t.currentPath:n.currentPath,"function"==typeof e&&(e=e());var i=e;return i||(i=n.options.basePath?n.options.basePath:"/"),i},getCriterias:function(t,n){void 0===n&&(n={}),n=e.extend({},{useBaseCriteria:!0,additionalCriterias:[]},n);var i=this,r=[];n.useBaseCriteria&&(r=i.options.baseCriteria.slice(0)),t&&(t+="*",r.push({i:i.options.searchParam,o:"plone.app.querystring.operation.string.contains",v:t}));var a=i.basePattern;return a.browsing&&r.push({i:"path",o:"plone.app.querystring.operation.string.path",v:i.getCurrentPath()+"::"+i.options.pathDepth}),r=r.concat(n.additionalCriterias)},getBatch:function(e){e||(e=1);var t=this;return{page:e,size:t.options.batchSize}},selectAjax:function(){var e=this;return{url:e.options.vocabularyUrl,dataType:"JSON",quietMillis:100,data:function(t,n){var i={query:JSON.stringify({criteria:e.getCriterias(t)}),batch:JSON.stringify(e.getBatch(n)),attributes:JSON.stringify(e.options.attributes)};return i},results:function(e,t){var n=10*t<e.total;return{results:e.results,more:n}}}},search:function(t,n,i,r,a){void 0===a&&(a=!0);var s=this,o=[];a&&(o=s.options.baseCriteria.slice(0)),o.push({i:t,o:n,v:i});var l={query:JSON.stringify({criteria:o}),attributes:JSON.stringify(s.options.attributes)};e.ajax({url:s.options.vocabularyUrl,dataType:"JSON",data:l,success:r})}});return n}),n("mockup-patterns-relateditems",["jquery","underscore","mockup-patterns-base","mockup-patterns-select2","mockup-patterns-queryhelper"],function(e,t,n,i,r){var a=n.extend({name:"relateditems",browsing:!1,currentPath:null,defaults:{vocabularyUrl:null,width:"300px",multiple:!0,tokenSeparators:[","," "],separator:",",orderable:!0,cache:!0,closeOnSelect:!1,basePath:"/",searchText:"Search:",searchAllText:"entire site",homeText:"home",folderTypes:["Folder"],selectableTypes:null,attributes:["UID","Title","Type","path"],dropdownCssClass:"pattern-relateditems-dropdown",maximumSelectionSize:-1,resultTemplate:'<div class="pattern-relateditems-result pattern-relateditems-type-<%= Type %> <% if (selected) { %>pattern-relateditems-active<% } %>">  <a href="#" class="pattern-relateditems-result-select <% if (selectable) { %>selectable<% } %>">    <span class="pattern-relateditems-result-title"><%= Title %></span>    <span class="pattern-relateditems-result-path"><%= path %></span>  </a>  <span class="pattern-relateditems-buttons">  <% if (folderish) { %>     <a class="pattern-relateditems-result-browse" href="#" data-path="<%= path %>"></a>   <% } %> </span></div>',resultTemplateSelector:null,selectionTemplate:'<span class="pattern-relateditems-item pattern-relateditems-type-<%= Type %>"> <span class="pattern-relateditems-item-title"><%= Title %></span> <span class="pattern-relateditems-item-path"><%= path %></span></span>',selectionTemplateSelector:null,breadCrumbsTemplate:'<span><span class="pattern-relateditems-path-label"><%= searchText %></span><a class="icon-home" href="/"></a><%= items %></span>',breadCrumbsTemplateSelector:null,breadCrumbTemplate:'/<a href="<%= path %>"><%= text %></a>',breadCrumbTemplateSelector:null,escapeMarkup:function(e){return e},setupAjax:function(){var t=this;return t.query=new r(t.$el,e.extend(!0,{},t.options,{basePattern:t})),t.query.valid?t.query.selectAjax():{}}},applyTemplate:function(n,i){var r,a=this;a.options[n+"TemplateSelector"]?(r=e(a.options[n+"TemplateSelector"]).html(),r||(r=a.options[n+"Template"])):r=a.options[n+"Template"];var s=e.extend(!0,{},a.options,i);return s._item=i,t.template(r,s)},activateBrowsing:function(){var e=this;e.browsing=!0,e.setBreadCrumbs()},deactivateBrowsing:function(){var e=this;e.browsing=!1,e.setBreadCrumbs()},browseTo:function(e){var t=this;t.trigger("before-browse"),t.currentPath=e,"/"===e?t.deactivateBrowsing():t.activateBrowsing(),t.$el.select2("close"),t.$el.select2("open"),t.trigger("after-browse")},setBreadCrumbs:function(){var n,i=this,r=i.currentPath?i.currentPath:i.options.basePath;if("/"===r)n=i.applyTemplate("breadCrumbs",{items:"<em>"+i.options.searchAllText+"</em>",searchText:i.options.searchText});else{var a=r.split("/"),s="",o="";t.each(a,function(e){if(""!==e){var t={};s=s+"/"+e,t.text=e,t.path=s,o+=i.applyTemplate("breadCrumb",t)}}),n=i.applyTemplate("breadCrumbs",{items:o,searchText:i.options.searchText})}var l=e(n);e("a",l).on("click",function(){return i.browseTo(e(this).attr("href")),!1}),i.$browsePath.html(l)},selectItem:function(e){var t=this;t.trigger("selecting");var n=t.$el.select2("data");n.push(e),t.$el.select2("data",n),e.selected=!0,t.trigger("selected")},deselectItem:function(e){var n=this;n.trigger("deselecting");var i=n.$el.select2("data");t.each(i,function(t,n){t.UID===e.UID&&i.splice(n,1)}),n.$el.select2("data",i),e.selected=!1,n.trigger("deselected")},isSelectable:function(e){var n=this;return null===n.options.selectableTypes?!0:t.indexOf(n.options.selectableTypes,e.Type)>-1},init:function(){var n=this;n.options.ajax=n.options.setupAjax.apply(n),n.$el.wrap('<div class="pattern-relateditems-container" />'),n.$container=n.$el.parents(".pattern-relateditems-container"),n.$container.width(n.options.width),i.prototype.initializeValues.call(n),i.prototype.initializeTags.call(n),n.options.formatSelection=function(e){return n.applyTemplate("selection",e)},i.prototype.initializeOrdering.call(n),n.options.formatResult=function(i){if(i.folderish=i.Type&&-1!==t.indexOf(n.options.folderTypes,i.Type)?!0:!1,i.selectable=n.isSelectable(i),void 0===i.selected){var r=n.$el.select2("data");i.selected=!1,t.each(r,function(e){e.UID===i.UID&&(i.selected=!0)})}var a=e(n.applyTemplate("result",i));return e(".pattern-relateditems-result-select",a).on("click",function(t){if(t.preventDefault(),e(this).is(".selectable")){var r=e(this).parents(".pattern-relateditems-result");if(r.is(".pattern-relateditems-active"))r.removeClass("pattern-relateditems-active"),n.deselectItem(i);else if(n.selectItem(i),r.addClass("pattern-relateditems-active"),n.options.maximumSelectionSize>0){var a=n.$select2.select2("data");a.length>=n.options.maximumSelectionSize&&n.$select2.select2("close")}}}),e(".pattern-relateditems-result-browse",a).on("click",function(t){t.preventDefault(),t.stopPropagation();var i=e(this).data("path");n.browseTo(i)}),e(a)},n.options.initSelection=function(t,i){var r=e(t).val();if(""!==r){var a=r.split(n.options.separator);n.query.search("UID","plone.app.querystring.operation.list.contains",a,function(e){i(e.results)},!1)}},n.options.id=function(e){return e.UID},i.prototype.initializeSelect2.call(n),{browseText:n.options.browseText,searchText:n.options.searchText},n.$browsePath=e('<span class="pattern-relateditems-path" />'),n.$container.prepend(n.$browsePath),n.deactivateBrowsing(),n.$el.on("select2-selecting",function(e){e.preventDefault()})}});return a}),n("mockup-patterns-querystring",["jquery","mockup-patterns-base","mockup-patterns-select2","mockup-patterns-pickadate"],function(e,t,n,i,r){var a=function(){this.init.apply(this,arguments)};a.prototype={defaults:{indexWidth:"20em",placeholder:"Select criteria",remove:"remove line",results:" items matching your search.",days:"days",betweendt:"to",classBetweenDtName:"querystring-criteria-betweendt",classWrapperName:"querystring-criteria-wrapper",classIndexName:"querystring-criteria-index",classOperatorName:"querystring-criteria-operator",classValueName:"querystring-criteria-value",classRemoveName:"querystring-criteria-remove",classResultsName:"querystring-criteria-results",classClearName:"querystring-criteria-clear"},init:function(t,n,i,a,s,o){var l=this;l.options=e.extend(!0,{},l.defaults,n),l.indexes=i,l.indexGroups={},l.$wrapper=e("<div/>").addClass(l.options.classWrapperName).appendTo(t),l.$remove=e("<div>"+l.options.remove+"</div>").addClass(l.options.classRemoveName).appendTo(l.$wrapper).on("click",function(){l.remove()}),l.$index=e("<select><option></option></select>").attr("placeholder",l.options.placeholder),e.each(l.indexes,function(t,n){n.enabled&&(l.indexGroups[n.group]||(l.indexGroups[n.group]=e("<optgroup/>").attr("label",n.group).appendTo(l.$index)),l.indexGroups[n.group].append(e("<option/>").attr("value",t).html(n.title)))}),l.$wrapper.append(e("<div/>").addClass(l.options.classIndexName).append(l.$index)),l.$index.patternSelect2({width:l.options.indexWidth,placeholder:l.options.placeholder}).on("change",function(e){l.removeValue(),l.createOperator(e.val),l.createClear(),l.trigger("index-changed")}),a!==r&&(l.$index.select2("val",a),l.createOperator(a,s,o),l.createClear()),l.trigger("create-criteria")},createOperator:function(t,n,i){var a=this;a.removeOperator(),a.$operator=e("<select/>"),a.indexes[t]&&e.each(a.indexes[t].operators,function(t,n){e("<option/>").attr("value",t).html(n.title).appendTo(a.$operator)}),a.$wrapper.append(e("<div/>").addClass(a.options.classOperatorName).append(a.$operator)),a.$operator.patternSelect2({width:"10em"}).on("change",function(){a.createValue(t),a.createClear(),a.trigger("operator-changed")}),n===r&&(n=a.$operator.select2("val")),a.$operator.select2("val",n),a.createValue(t,i),a.trigger("create-operator")},createValue:function(t,n){var i=this,a=i.indexes[t].operators[i.$operator.val()].widget,s=e("<div/>").addClass(i.options.classValueName).appendTo(i.$wrapper);if(i.removeValue(),"StringWidget"===a)i.$value=e('<input type="text"/>').addClass(i.options.classValueName+"-"+a).val(n).appendTo(s).change(function(){i.trigger("value-changed")});else if("DateWidget"===a)i.$value=e('<input type="text"/>').addClass(i.options.classValueName+"-"+a).appendTo(s).patternPickadate({time:!1,date:{format:"dd/mm/yyyy"}}).change(function(){i.trigger("value-changed")});else if("DateRangeWidget"===a){var o=e("<span/>").appendTo(s),l=e('<input type="text"/>').addClass(i.options.classValueName+"-"+a).addClass(i.options.classValueName+"-"+a+"-start").appendTo(o).patternPickadate({time:!1,date:{format:"dd/mm/yyyy"}});s.append(e("<span/>").html(i.options.betweendt).addClass(i.options.classBetweenDtName));var c=e("<span/>").appendTo(s),u=e('<input type="text"/>').addClass(i.options.classValueName+"-"+a).addClass(i.options.classValueName+"-"+a+"-end").appendTo(c).patternPickadate({time:!1,date:{format:"dd/mm/yyyy"}});s.find(".picker__input").change(function(){i.trigger("value-changed")}),i.$value=[l,u]}else"RelativeDateWidget"===a?i.$value=e('<input type="text"/>').after(e("<span/>").html(i.options.days)).addClass(i.options.classValueName+"-"+a).appendTo(s).change(function(){i.trigger("value-changed")}):"ReferenceWidget"===a?i.$value=e('<input type="text"/>').addClass(i.options.classValueName+"-"+a).appendTo(s).change(function(){i.trigger("value-changed")}):"RelativePathWidget"===a?i.$value=e('<input type="text"/>').addClass(i.options.classValueName+"-"+a).appendTo(s).val(n).change(function(){i.trigger("value-changed")}):"MultipleSelectionWidget"===a&&(i.$value=e("<select/>").attr("multiple",!0).addClass(i.options.classValueName+"-"+a).appendTo(s).change(function(){i.trigger("value-changed")}),i.indexes[t]&&e.each(i.indexes[t].values,function(t,n){e("<option/>").attr("value",t).html(n.title).appendTo(i.$value)}),i.$value.patternSelect2({width:"250px"}));n!==r&&"undefined"!=typeof i.$value&&i.$value.select2("val",n),i.trigger("create-value")},createClear:function(){var t=this;t.removeClear(),t.$clear=e("<div/>").addClass(t.options.classClearName).appendTo(t.$wrapper)},remove:function(){var e=this;e.trigger("remove"),e.$remove.remove(),e.$index.parent().remove(),e.removeOperator(),e.removeValue(),e.removeClear(),e.$wrapper.remove()},removeClear:function(){var e=this;e.trigger("remove-clear"),e.$clear&&e.$clear.remove()},removeOperator:function(){var e=this;e.trigger("remove-operator"),e.$operator&&e.$operator.parent().remove()},removeValue:function(){var t=this;t.trigger("remove-value"),t.$value&&(e.isArray(t.$value)?t.$value[0].parents(".querystring-criteria-value").remove():t.$value.parents(".querystring-criteria-value").remove())},buildQueryPart:function(){var t=this,n=t.$index.select2("val");if(""===n)return"";var i="query.i:records="+n;if("undefined"==typeof t.$operator)return"";var r=t.$operator.val(),a="query.o:records="+r,s="query.v:records=",o="query.v:records:list=",l=[];return"undefined"==typeof t.$value?l.push(s):e.isArray(t.$value)?e.each(t.$value,function(){l.push(o+e(this).parent().find(".picker__input").val())}):l.push(s+t.$value.val()),i+"&"+a+"&"+l.join("&")},getJSONListStr:function(){var t=this,n=t.$index.select2("val");if(""===n)return"";if("undefined"==typeof t.$operator)return"";var i=t.$operator.val(),r=[];e.isArray(t.$value)?e.each(t.$value,function(){r.push(e(this).parent().find(".picker__input").val())}):"undefined"!=typeof t.$value&&r.push(t.$value.val());var a;return a=r.length>1?'["'+r.join('","')+'"]':1===r.length?JSON.stringify(r[0]):'""','{"i":"'+n+'", "o":"'+i+'", "v":'+a+"}"},trigger:function(e){this.$wrapper.trigger(e+"-criteria.querystring.patterns",[this])},on:function(e,t){this.$wrapper.on(e+"-criteria.querystring.patterns",t)}};var s=t.extend({name:"querystring",defaults:{indexes:[],classWrapperName:"querystring-wrapper",criteria:{},indexOptionsUrl:null,previewURL:"portal_factory/@@querybuilder_html_results",previewCountURL:"portal_factory/@@querybuildernumberofresults",sorttxt:"Sort On",reversetxt:"Reversed Order",previewTitle:"Preview",previewDescription:"Preview of at most 10 items",classSortLabelName:"querystring-sort-label",classSortReverseName:"querystring-sortreverse",classSortReverseLabelName:"querystring-sortreverse-label",classPreviewCountWrapperName:"querystring-previewcount-wrapper",classPreviewResultsWrapperName:"querystring-previewresults-wrapper",classPreviewWrapperName:"querystring-preview-wrapper",classPreviewName:"querystring-preview",classPreviewTitleName:"querystring-preview-title",classPreviewDescriptionName:"querystring-preview-description",classSortWrapperName:"querystring-sort-wrapper",showPreviews:!0},init:function(){var t=this;t.$el.hide(),t.$wrapper=e("<div/>"),t.$el.after(t.$wrapper),t.initialized=!1,t.options.indexOptionsUrl?e.ajax({url:t.options.indexOptionsUrl,success:function(e){t.options.indexes=e.indexes,t.options.sortable_indexes=e.sortable_indexes,t._init()},error:function(){}}):t._init()},_init:function(){var t=this;t.$criteriaWrapper=e("<div/>").addClass(t.options.classWrapperName).appendTo(t.$wrapper),t.$sortWrapper=e("<div/>").addClass(t.options.classSortWrapperName).appendTo(t.$wrapper),"false"===t.options.showPreviews&&(t.options.showPreviews=!1),t.options.showPreviews&&(t.$previewWrapper=e("<div/>").addClass(t.options.classPreviewWrapperName).appendTo(t.$wrapper),e("<div/>").addClass(t.options.classPreviewTitleName).html(t.options.previewTitle).appendTo(t.$previewWrapper),e("<div/>").addClass(t.options.classPreviewDescriptionName).html(t.options.previewDescription).appendTo(t.$previewWrapper)),t.criterias=[],t.$el.val()&&e.each(JSON.parse(t.$el.val()),function(e,n){t.createCriteria(n.i,n.o,n.v)}),t.createCriteria(),t.createSort(),t.options.showPreviews&&t.refreshPreviewEvent(),t.$el.trigger("initialized"),t.initialized=!0},createCriteria:function(e,t,n){var i=this,r=new a(i.$criteriaWrapper,i.options.criteria,i.options.indexes,e,t,n);r.on("remove",function(){i.criterias[i.criterias.length-1]===r&&i.createCriteria()}),r.on("index-changed",function(){i.criterias[i.criterias.length-1]===r&&i.createCriteria()});var s=function(){i.refreshPreviewEvent(),i.updateValue()};r.on("remove",function(e,t){-1!==i.criterias.indexOf(t)&&i.criterias.splice(i.criterias.indexOf(t),1),s(e,t)}),r.on("remove-clear",s),r.on("remove-operator",s),r.on("remove-value",s),r.on("index-changed",s),r.on("operator-changed",s),r.on("create-criteria",s),r.on("create-operator",s),r.on("create-value",s),r.on("value-changed",s),i.criterias.push(r)},createSort:function(){var t=this,n=e('[id$="-sort_on"]').filter('[id^="formfield-"]'),i=e('[id$="-sort_reversed"]').filter('[id^="formfield-"]');e("<span/>").addClass(t.options.classSortLabelName).html(t.options.sorttxt).appendTo(t.$sortWrapper),t.$sortOn=e("<select/>").attr("name","sort_on").appendTo(t.$sortWrapper).change(function(){t.refreshPreviewEvent.call(t),e('[id$="sort_on"]',n).val(e(this).val())}),t.$sortOn.append(e('<option value="">No sorting</option>'));for(var r in t.options.sortable_indexes)t.$sortOn.append(e("<option/>").attr("value",r).html(t.options.indexes[r].title));if(t.$sortOn.patternSelect2({width:150}),t.$sortOrder=e("<input type='checkbox' />").attr("name","sort_reversed:boolean").change(function(){t.refreshPreviewEvent.call(t),"checked"===e(this).attr("checked")?e('.option input[type="checkbox"]',i).attr("checked","checked"):e('.option input[type="checkbox"]',i).removeAttr("checked")}),e("<span/>").addClass(t.options.classSortReverseName).appendTo(t.$sortWrapper).append(t.$sortOrder).append(e("<span/>").html(t.options.reversetxt).addClass(t.options.classSortReverseLabelName)),n.length>=1&&i.length>=1){var a="checked"===e('.option input[type="checkbox"]',i).attr("checked"),s=e('[id$="-sort_on"]',n).val();a&&t.$sortOrder.attr("checked","checked"),t.$sortOn.select2("val",s),e(n).hide(),e(i).hide()}},refreshPreviewEvent:function(){var t=this;if(t.options.showPreviews){"undefined"!=typeof t._preview_xhr&&t._preview_xhr.abort(),"undefined"!=typeof t.$previewPane&&t.$previewPane.remove();var n,i=[];if(e.each(t.criterias,function(e,t){n=t.buildQueryPart(),""!==n&&i.push(t.buildQueryPart())}),t.$previewPane=e("<div/>").addClass(t.options.classPreviewName).appendTo(t.$previewWrapper),i.length<=0)return e("<div/>").addClass(t.options.classPreviewCountWrapperName).html("No results to preview").prependTo(t.$previewPane),void 0;i.push("sort_on="+t.$sortOn.val());var r=t.$sortOrder.attr("checked");"checked"===r&&i.push("sort_order=reverse"),t._preview_xhr=e.get(t.options.previewURL+"?"+i.join("&")).done(function(n){e("<div/>").addClass(t.options.classPreviewResultsWrapperName).html(n).appendTo(t.$previewPane)})}},updateValue:function(){var t=this,n=[];e.each(t.criterias,function(e,t){var i=t.getJSONListStr();""!==i&&n.push(i)}),t.$el.val();var i="["+n.join(",")+"]";t.$el.val(i),t.$el.trigger("change")}});return s}),window.jQuery&&n("jquery",[],function(){return window.jQuery}),n("mockup-bundles-widgets",["jquery","mockup-registry","mockup-patterns-base","mockup-patterns-select2","mockup-patterns-pickadate","mockup-patterns-relateditems","mockup-patterns-querystring"],function(e,t,n){var i=n.extend({name:"plone-widgets",init:function(){}});return window.parent===window&&e(document).ready(function(){e("body").addClass("pat-plone-widgets"),t.scan(e("body"))}),i}),t(["mockup-bundles-widgets"])}();